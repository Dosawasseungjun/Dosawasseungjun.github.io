<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  <!-- â˜… ë„¤ì´ë²„ ì‚¬ì´íŠ¸ ì¸ì¦ ë©”íƒ€íƒœê·¸ ì¶”ê°€ -->
  <meta name="naver-site-verification" content="0433b52fdb8101f89b796ec1fa14d6cfe85bd8c6" /><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Heavy-Light decomposition" />
<meta property="og:locale" content="ko" />
<meta name="description" content="HLD(Heavy Light Decomposition) ğŸ’¡ íŠ¸ë¦¬ì—ì„œ ì„ì˜ì˜ ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì— ëŒ€í•œ ì¿¼ë¦¬ê°€ ê¶ê¸ˆí•  ë•Œ. êµ¬í˜„ê³¼ì • êµ¬í˜„ê³¼ì •ì€ jinhanë‹˜ì˜ ë¸”ë¡œê·¸ ë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬í˜„í–ˆë‹¤. ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ê·¸ë˜í”„ë¼ë©´ adjì— ê°€ì¤‘ì¹˜ ì—†ëŠ” ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê³ , cost[ì •ì ]ì— í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°ˆ ë•Œ ë“œëŠ” ë¹„ìš©ì„ ì €ì¥í•œë‹¤. ê·¸ë¦¬ê³  input[i] = {u, v}ì´ëŸ° ì‹ìœ¼ë¡œ ì •ì ì— ë²ˆí˜¸ë¥¼ ë¶™ì—¬ì¤€ë‹¤.(ì„¸ê·¸íŠ¸ë¦¬ë¡œ ë‹¤ë£¨ê¸° ìœ„í•¨) dfs1ì„ ëŒë©´ì„œ ê° ì •ì ì˜ ê¹Šì´(dep), ê° ì •ì ì˜ ë¶€ëª¨ ì •ì (par), ê° ì •ì ì´ ë§Œë“œëŠ” ì„œë¸ŒíŠ¸ë¦¬ í¬ê¸°(sz)ë¥¼ ì €ì¥í•œë‹¤. ì´ ë•Œ adj[ì •ì ][0]ì—ëŠ” ê°€ì¥ ë¬´ê±°ìš´ ê°„ì„ ì´ ë˜ë„ë¡ í•œë‹¤. dfs2ë¥¼ ëŒë©´ì„œ ì˜¤ì¼ëŸ¬íˆ¬ì–´ í…Œí¬ë‹‰ì„ ì ìš©í•˜ê³  ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ ì§€ë‹ˆëŠ” ì •ì ì¸ì§€ë¥¼ ì²´í¬í•œë‹¤. (top) ì •ë¦¬í•´ë³´ë©´ input[i] = ië²ˆì§¸ ì •ì ì€ {xxì •ì , yyì •ì }ë¥¼ ì‡ëŠ” ê°„ì„ ì…ë‹ˆë‹¤. inp[i] : ì§ì ‘ ì…ë ¥ ë°›ì€ ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ì¸ì ‘ ë¦¬ìŠ¤íŠ¸ ê·¸ë˜í”„ adj[i] : inpì„ ë°”ê¿”ì„œ ê°€ì¤‘ì¹˜ë¥¼ ë–¼ì–´ë‚¸ ê·¸ë˜í”„ cost[i] : ië²ˆ ì§¸ ì •ì ê¹Œì§€ ê°€ëŠ”ë° ë“œëŠ” ê°€ì¤‘ì¹˜(ë¹„ìš©) dep, par, szëŠ” ìœ„ì— ì„¤ëª…í–ˆê³  in, out â†’ ì˜¤ì¼ëŸ¬ íˆ¬ì–´ í…Œí¬ë‹‰(DFS ordering)í•˜ê³  ë‚œ ê²°ê³¼ in[ì–´ë–¤ ì •ì ]ì´ ì§€ì¹­í•˜ëŠ” ê°„ì„  ë²ˆí˜¸ top[i] : ië²ˆ ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ë©´ 0 ì•„ë‹ˆë©´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ëŠ” ì •ì ì„ ì €ì¥í•´ë‘ . ì´ì œ ìš°ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì! ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§„ ê°„ì„ ì€ ë¬´ì—‡ì¼ê¹Œ? ì´ ë•Œ, ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ëŠ” ë³€í•  ìˆ˜ ìˆë‹¤. â†’ 13510 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬ ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ê²ƒ ì´ë‹¤. 1 2 3 4 5 6 //update ì—°ì‚° , xstëŠ” maxSegmentTreeì´ë‹¤. // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].xx, input[i].yy); xst.update(in[input[i].xx], val, 1, 1, n); } ìœ„ ì½”ë“œë¥¼ ë³´ë©´ depê°€ ê¹Šì€ ì •ì ì— í•´ë‹¹í•˜ëŠ” ê°„ì„ ì„ valë¡œ ë³€í™”ì‹œí‚¨ë‹¤. 2ë²ˆì— í•´ë‹¹í•˜ëŠ” ì½”ë“œì´ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //query ì—°ì‚° //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int st = top[u]; ret = max(ret, xst.xquery(in[st], in[u], 1, 1, n)); u = par[st]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); T nxt = -1; for(auto i : adj[u]) if(top[i]==top[u]) nxt = i; ret = max(ret, xst.xquery(in[nxt], in[v], 1, 1, n)); return ret; } ì´ëŠ” 1ë²ˆ - ì¦‰ ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ êµ¬í•˜ëŠ” ì¿¼ë¦¬ì´ë‹¤. top[ì–´ë–¤ ì •ì ]ì€ ê°„ì„  ë¶„ë¥˜ì˜ ë§¨ ìœ„ë¡œ ì˜¬ë¼ê°„ë‹¤ëŠ” ëœ»ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 5 - 7ë¡œ ê°„ë‹¤ê³  í•˜ë©´ 5ë‘ 7ì˜ ê¹Šì´ê°€ ê°™ìœ¼ë‹ˆê¹Œ u = 5, v = 7 uë¥¼ st = top[u] = 2ì´ë‹¤. íŒŒë€ ê°„ì„ ì´ ëë‚˜ëŠ” ì •ì ê¹Œì§€ ê°€ê³  ì´ ë•Œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¡œ ê²½ë¡œ ìƒ íŒŒë€ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤). ë‹¤ìŒì—” u = 7, v = 2ê°€ ë  ê²ƒì´ê³  top[u] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë…¸ë€ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ë‹¤ìŒì—” u = 2, v = 1ì´ ë  ê²ƒì´ê³  top[2] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë¹¨ê°„ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ì´ëŸ° ì‹ìœ¼ë¡œ ë¬´ê±°ìš´ ê°„ì„ ì„ í†µí•´ ë¶„ë¥˜í•œ ê°„ì„ ìœ¼ë¡œ ì­‰ì­‰ ì´ë™í•˜ë©´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ HLDì´ë‹¤. ì´ë•Œ ì´ ê°„ì„ ì˜ ì¢…ë¥˜ê°€ $logN$ê°œ ì´ë¯€ë¡œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ í•˜ëŠ” $logN$ê³¼ í•©ì³ ì´ ì‹œê°„ ë³µì¡ë„ : $O((logN)^2)$ìœ¼ë¡œ ê° ì¿¼ë¦¬ë¥¼ í•´ê²° í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. 13309 íŠ¸ë¦¬ íŠ¸ë¦¬ê°€ ê°€ì¤‘ì¹˜ 1ë¡œ ëª¨ë‘ ì—°ê²° ë˜ì–´ìˆë‹¤ê³  í•˜ê³  ì—°ê²°ì´ ëŠì–´ì§€ë©´ updateì—°ì‚°ìœ¼ë¡œ í•´ë‹¹ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ êµ¬í•œ ê²½ë¡œì˜ ê¸¸ì´ê°€ $dep[u] + dep[v] - dep[lca(u, v)]$ ì™€ ê°™ë‹¤ë©´ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì´ê³  ë‚˜ë¨¸ì§€ ê²½ìš°ëŠ” ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤. ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 2e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 1, n); u = par[ST]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 1, n); int LCA = lca(u, v); ret -= st.query(in[LCA], in[LCA], 1, 1, n); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int p; cin &gt;&gt; p; input[i-1] = {p, i}; inp[p].push_back({1, i}); inp[i].push_back({1, p}); } for(int i=1;i&lt;=n;i++){ st.update(i, 1, 1, 1, n); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n &gt;&gt; q; hld.n = n; hld.precal(); while (q--) { int u, v, o; cin &gt;&gt; u &gt;&gt; v &gt;&gt; o; bool ok = false; if(hld.query(u, v)==hld.dep[u]+hld.dep[v]-2*hld.dep[hld.lca(u, v)]){ ok = true; cout &lt;&lt; &quot;YES\n&quot;; }else{ cout &lt;&lt; &quot;NO\n&quot;; } if(o){ if(ok) hld.st.update(hld.in[u], 0, 1, 1, n); else hld.st.update(hld.in[v], 0, 1, 1, n); } } } 13512 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬3 1ë²ˆ ì¿¼ë¦¬ëŠ” íŠ¸ë¦¬ì˜ ìƒ‰ì„ ë°”ê¾¸ëŠ” ì—°ì‚°ì€ XOR 1ì—°ì‚°ì„ í†µí•´ í•´ê²° í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. 2ë²ˆ ì¿¼ë¦¬ëŠ” 1ë²ˆ ë¶€í„° í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°€ë©´ì„œ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ ì°¾ìœ¼ë©´ ëœë‹¤. 2ë²ˆ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë¬¸ì œì¸ë°â€¦ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ êµ¬í•˜ëŠ” ë°©ë²•ì€ ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•˜ë©´ ëœë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; //Lë¶€í„° ê²€ì‚¬í•˜ëŠ”ê²Œ ì¤‘ìš”!! loëŠ” off-by-one errorë•œì— 1ì„ ëºìŒ if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } ì´ë¥¼ ì´ìš©í•˜ì—¬ êµ¬ê°„ì— 1ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ -1 ë¦¬í„´ êµ¬ê°„ì— ì¡´ì¬í•˜ë©´ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” ê³³ì˜ dfs order ë²ˆí˜¸ë¥¼ ë¦¬í„´í•œë‹¤. ë¬¸ì œëŠ” ê°€ì¥ ë¨¼ì € 1ì´ ë‚˜ì˜¤ëŠ” ê³³ì˜ ì •ì  idxë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— dfs orderingì„ í•  ë•Œ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•´ë†“ëŠ” ê²ƒì´ í¸í•˜ë‹¤. ë‚˜ëŠ” Rì´ë¼ëŠ” ë°°ì—´ì„ ì´ìš©í–ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 1e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] ^= v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; T R[MAXSIZE]; //inì˜ ì—­í•¨ìˆ˜ë¥¼ ì„¤ì •í–ˆìŒ vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; R[tmp] = now; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” 1 T query(T u, T v){ T ret = -1; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; int now = st.bisearch(in[ST], in[u]); if(now&gt;0) ret = now; u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); int now = st.bisearch(in[u], in[v]); if(now&gt;0) ret = now; return ((ret==-1) ? ret : R[ret]); } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int u, v; cin &gt;&gt; u &gt;&gt; v; input[i-1] = {u, v}; inp[u].push_back({1, v}); inp[v].push_back({1, u}); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n; hld.n = n; hld.precal(); cin &gt;&gt; q; while (q--) { int op, v; cin &gt;&gt; op &gt;&gt; v; if(op==1){ hld.st.update(hld.in[v], 1, 1, 1, MAXSIZE); }else{ cout &lt;&lt; hld.query(1, v) &lt;&lt; &#39;\n&#39;; } } } 2927 ë‚¨ê·¹íƒí—˜ ìš°ë¦¬ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ í™•ì •ëœ ìƒíƒœì—ì„œ HLDë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œë¥¼ í’€ì—ˆì§€ë§Œ ì´ ë¬¸ì œëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ ì™„ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì´ëŸ° ê²½ìš° ì™„ì„± ë˜ì—ˆì„ ë•Œì˜ ë¬¸ì œë¡œ ì¹˜í™˜ì„ í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤. ì´ ë•Œ ì˜¤í”„ë¼ì¸ ì¿¼ë¦¬ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ì¼ë‹¨, bridgeì—°ì‚°ì€ Union Findë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ì—°ì‚°ì„ í†µí•´ ë§Œë“¤ì–´ì§„ ê·¸ë˜í”„ëŠ” ë¬´ì¡°ê±´ íŠ¸ë¦¬ í˜•íƒœì´ë‹¤. í•˜ì§€ë§Œ bridgeì—°ì‚°ì´ ì •í™•íˆ n-1ê°œì˜ yesê°€ ë‚˜ì˜¨ë‹¤ëŠ” ë³´ì¥ì´ ì—†ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ íŠ¸ë¦¬ê°€ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ íŠ¸ë¦¬ë¥¼ í•©ì³ì„œ í•˜ë‚˜ì˜ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆì—ˆë‹¤. ì´ì œ excursion ì—°ì‚°ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ì. excursionì€ ì¼ë‹¨ ê¸¸ì´ ì—†ìœ¼ë©´ â€œinpossibleâ€ì„ ì¶œë ¥í•œë‹¤. ê·¼ë° ì´ ê²½ìš°ëŠ” ê·¸ëƒ¥ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œë„ í•´ê²° í•  ìˆ˜ ìˆë‹¤. ë‚˜ë¨¸ì§€ ê¸¸ì´ ìˆëŠ” ê²½ìš°ëŠ” íŠ¸ë¦¬ì—ì„œëŠ” ì •ì  u, v ì‚¬ì´ì˜ ê¸¸ì´ í•˜ë‚˜ ë°–ì— ì—†ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ HLDì´ìš©í•˜ë©´ ëœë‹¤. ê²°ë¡  : â†’ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œ excursionì¤‘ì— ë¶ˆê°€ëŠ¥í•œ ê±°ëŠ” ë¯¸ë¦¬ ê³¨ë¼ ë‘”ë‹¤. â†’ ì´ì œ ì™„ì„±ëœ íŠ¸ë¦¬ë¥¼ ê°€ì§€ê³  ì¿¼ë¦¬ë¥¼ ê±°ê¾¸ë¡œ ë³´ë©´ì„œ ê²½ë¡œ ì¿¼ë¦¬ë¡œ ê¸¸ì´ ìˆëŠ” ê²½ìš°ë¥¼ ê³„ì‚°í•œë‹¤. â†’ penguins ì—°ì‚°ì€ ì—­ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ì‹ìœ¼ë¡œ í•´ì•¼í•œë‹¤. (ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ updateí•˜ë©´ ëœë‹¤. ) ë§ˆì§€ë§‰ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë•Œ bridgeë¼ë©´ ë¯¸ë¦¬ ì €ì¥ëœ 1 â†’ yes 0 â†’ no penguinsë¼ë©´ continue excursionë¼ë©´ Unionfindë¡œ í‰ê°€í–ˆì„ ë•Œ ì´ë¯¸ -1 â†’ â€œimpossibleâ€ ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ query(a, b) ìì„¸í•œê±´ ì•„ë˜ ì½”ë“œì—ì„œ ì£¼ì„ ì²˜ë¦¬ë¡œ ë³´ì´ê² ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 3e4+1; int P[MAXSIZE]; struct DisjointSet{ vector&lt;int&gt; parent, rank; DisjointSet(int n):parent(n+1),rank(n+1, 0){ for(int i=0;i&lt;=n;i++){ parent[i] = i; } } int find(int u){ if(u==parent[u]) return u; return parent[u] = find(parent[u]); } bool merge(int u, int v){ u = find(u); v = find(v); if(u==v) return true; if(rank[u]&gt;rank[v]) swap(u, v); parent[u] = v; if(rank[u]==rank[v]) rank[v]++; return false; } bool check(int u, int v){ u = find(u); v = find(v); if(u==v) return true; return false; } }; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 0){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 0){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = -1; void dfs2(int now = 0){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 0, n); } //u, vê²½ë¡œìƒ í­ê·„ì˜ ìˆ˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 0, MAXSIZE); u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 0, MAXSIZE); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ for(int i=1;i&lt;=n;i++){ inp[0].push_back({1, i}); inp[i].push_back({1, 0}); } top[0] = 1; dfs(); dfs1(); dfs2(); } }; DisjointSet uf(MAXSIZE); HLD&lt;int&gt; hld; class Data{ public: string op; int a, b ,idx, p,q; }; pair&lt;string, int&gt; ans[300005]; int main(){ fast_io int n; cin &gt;&gt; n; hld.n = n; for(int i=1;i&lt;=n;i++) cin &gt;&gt; P[i]; int q; cin &gt;&gt; q; vector&lt;Data&gt; Q(q+1); for(int i=1;i&lt;=q;i++){ string op; int a, b; cin &gt;&gt; op &gt;&gt; a &gt;&gt; b; if(op==&quot;bridge&quot;){ if(uf.merge(a, b)){//ì´ë¯¸ í•©ì³ì ¸ìˆìŒ ans[i] = {&quot;bridge&quot;, 0}; }else{//í•©ì³ì•¼í•¨ ans[i] = {&quot;bridge&quot;, 1}; hld.inp[a].push_back({1, b}); hld.inp[b].push_back({1, a}); } Q[i] = {op, a, b, i, -1, -1}; }else if(op==&quot;penguins&quot;){ Q[i] = {op, a, b, i, P[a], b}; P[a] = b; }else{ if(uf.check(a, b)){ //ì´ë¯¸ í•©ì³ì ¸ ìˆìŒ Q[i] = {op, a, b, i, a, b}; }else{ ans[i] = {&quot;excursion&quot;, -1}; Q[i] = {op, a, b, i, -1, -1}; } } } hld.precal(); //0ì´ ë£¨íŠ¸ì¸ í•˜ë‚˜ì˜ íŠ¸ë¦¬ for(int i=1;i&lt;=n;i++){ //í­ê·„ì„ ê° ì„¬ì— ë„£ì–´ì¤Œ hld.st.update(hld.in[i], P[i], 1, 0, MAXSIZE); } for(int i=q;i&gt;=1;i--){ if(Q[i].op==&quot;bridge&quot;) continue; if(Q[i].op==&quot;penguins&quot;){ hld.st.update(hld.in[Q[i].a], Q[i].p, 1, 0, MAXSIZE); ans[Q[i].idx] = {Q[i].op, 0}; }else{ if(Q[i].p==-1) continue; ans[Q[i].idx] = {Q[i].op, hld.query(Q[i].a, Q[i].b)}; } } for(int i=1;i&lt;=q;i++){ if(ans[i].xx==&quot;bridge&quot;){ if(ans[i].yy) cout &lt;&lt; &quot;yes\n&quot;; else cout &lt;&lt; &quot;no\n&quot;; }else if(ans[i].xx==&quot;penguins&quot;){ continue; }else{ if(ans[i].yy==-1) cout &lt;&lt; &quot;impossible\n&quot;; else cout &lt;&lt; ans[i].yy &lt;&lt; &#39;\n&#39;; } } }" />
<meta property="og:description" content="HLD(Heavy Light Decomposition) ğŸ’¡ íŠ¸ë¦¬ì—ì„œ ì„ì˜ì˜ ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì— ëŒ€í•œ ì¿¼ë¦¬ê°€ ê¶ê¸ˆí•  ë•Œ. êµ¬í˜„ê³¼ì • êµ¬í˜„ê³¼ì •ì€ jinhanë‹˜ì˜ ë¸”ë¡œê·¸ ë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬í˜„í–ˆë‹¤. ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ê·¸ë˜í”„ë¼ë©´ adjì— ê°€ì¤‘ì¹˜ ì—†ëŠ” ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê³ , cost[ì •ì ]ì— í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°ˆ ë•Œ ë“œëŠ” ë¹„ìš©ì„ ì €ì¥í•œë‹¤. ê·¸ë¦¬ê³  input[i] = {u, v}ì´ëŸ° ì‹ìœ¼ë¡œ ì •ì ì— ë²ˆí˜¸ë¥¼ ë¶™ì—¬ì¤€ë‹¤.(ì„¸ê·¸íŠ¸ë¦¬ë¡œ ë‹¤ë£¨ê¸° ìœ„í•¨) dfs1ì„ ëŒë©´ì„œ ê° ì •ì ì˜ ê¹Šì´(dep), ê° ì •ì ì˜ ë¶€ëª¨ ì •ì (par), ê° ì •ì ì´ ë§Œë“œëŠ” ì„œë¸ŒíŠ¸ë¦¬ í¬ê¸°(sz)ë¥¼ ì €ì¥í•œë‹¤. ì´ ë•Œ adj[ì •ì ][0]ì—ëŠ” ê°€ì¥ ë¬´ê±°ìš´ ê°„ì„ ì´ ë˜ë„ë¡ í•œë‹¤. dfs2ë¥¼ ëŒë©´ì„œ ì˜¤ì¼ëŸ¬íˆ¬ì–´ í…Œí¬ë‹‰ì„ ì ìš©í•˜ê³  ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ ì§€ë‹ˆëŠ” ì •ì ì¸ì§€ë¥¼ ì²´í¬í•œë‹¤. (top) ì •ë¦¬í•´ë³´ë©´ input[i] = ië²ˆì§¸ ì •ì ì€ {xxì •ì , yyì •ì }ë¥¼ ì‡ëŠ” ê°„ì„ ì…ë‹ˆë‹¤. inp[i] : ì§ì ‘ ì…ë ¥ ë°›ì€ ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ì¸ì ‘ ë¦¬ìŠ¤íŠ¸ ê·¸ë˜í”„ adj[i] : inpì„ ë°”ê¿”ì„œ ê°€ì¤‘ì¹˜ë¥¼ ë–¼ì–´ë‚¸ ê·¸ë˜í”„ cost[i] : ië²ˆ ì§¸ ì •ì ê¹Œì§€ ê°€ëŠ”ë° ë“œëŠ” ê°€ì¤‘ì¹˜(ë¹„ìš©) dep, par, szëŠ” ìœ„ì— ì„¤ëª…í–ˆê³  in, out â†’ ì˜¤ì¼ëŸ¬ íˆ¬ì–´ í…Œí¬ë‹‰(DFS ordering)í•˜ê³  ë‚œ ê²°ê³¼ in[ì–´ë–¤ ì •ì ]ì´ ì§€ì¹­í•˜ëŠ” ê°„ì„  ë²ˆí˜¸ top[i] : ië²ˆ ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ë©´ 0 ì•„ë‹ˆë©´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ëŠ” ì •ì ì„ ì €ì¥í•´ë‘ . ì´ì œ ìš°ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì! ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§„ ê°„ì„ ì€ ë¬´ì—‡ì¼ê¹Œ? ì´ ë•Œ, ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ëŠ” ë³€í•  ìˆ˜ ìˆë‹¤. â†’ 13510 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬ ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ê²ƒ ì´ë‹¤. 1 2 3 4 5 6 //update ì—°ì‚° , xstëŠ” maxSegmentTreeì´ë‹¤. // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].xx, input[i].yy); xst.update(in[input[i].xx], val, 1, 1, n); } ìœ„ ì½”ë“œë¥¼ ë³´ë©´ depê°€ ê¹Šì€ ì •ì ì— í•´ë‹¹í•˜ëŠ” ê°„ì„ ì„ valë¡œ ë³€í™”ì‹œí‚¨ë‹¤. 2ë²ˆì— í•´ë‹¹í•˜ëŠ” ì½”ë“œì´ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //query ì—°ì‚° //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int st = top[u]; ret = max(ret, xst.xquery(in[st], in[u], 1, 1, n)); u = par[st]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); T nxt = -1; for(auto i : adj[u]) if(top[i]==top[u]) nxt = i; ret = max(ret, xst.xquery(in[nxt], in[v], 1, 1, n)); return ret; } ì´ëŠ” 1ë²ˆ - ì¦‰ ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ êµ¬í•˜ëŠ” ì¿¼ë¦¬ì´ë‹¤. top[ì–´ë–¤ ì •ì ]ì€ ê°„ì„  ë¶„ë¥˜ì˜ ë§¨ ìœ„ë¡œ ì˜¬ë¼ê°„ë‹¤ëŠ” ëœ»ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 5 - 7ë¡œ ê°„ë‹¤ê³  í•˜ë©´ 5ë‘ 7ì˜ ê¹Šì´ê°€ ê°™ìœ¼ë‹ˆê¹Œ u = 5, v = 7 uë¥¼ st = top[u] = 2ì´ë‹¤. íŒŒë€ ê°„ì„ ì´ ëë‚˜ëŠ” ì •ì ê¹Œì§€ ê°€ê³  ì´ ë•Œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¡œ ê²½ë¡œ ìƒ íŒŒë€ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤). ë‹¤ìŒì—” u = 7, v = 2ê°€ ë  ê²ƒì´ê³  top[u] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë…¸ë€ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ë‹¤ìŒì—” u = 2, v = 1ì´ ë  ê²ƒì´ê³  top[2] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë¹¨ê°„ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ì´ëŸ° ì‹ìœ¼ë¡œ ë¬´ê±°ìš´ ê°„ì„ ì„ í†µí•´ ë¶„ë¥˜í•œ ê°„ì„ ìœ¼ë¡œ ì­‰ì­‰ ì´ë™í•˜ë©´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ HLDì´ë‹¤. ì´ë•Œ ì´ ê°„ì„ ì˜ ì¢…ë¥˜ê°€ $logN$ê°œ ì´ë¯€ë¡œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ í•˜ëŠ” $logN$ê³¼ í•©ì³ ì´ ì‹œê°„ ë³µì¡ë„ : $O((logN)^2)$ìœ¼ë¡œ ê° ì¿¼ë¦¬ë¥¼ í•´ê²° í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. 13309 íŠ¸ë¦¬ íŠ¸ë¦¬ê°€ ê°€ì¤‘ì¹˜ 1ë¡œ ëª¨ë‘ ì—°ê²° ë˜ì–´ìˆë‹¤ê³  í•˜ê³  ì—°ê²°ì´ ëŠì–´ì§€ë©´ updateì—°ì‚°ìœ¼ë¡œ í•´ë‹¹ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ êµ¬í•œ ê²½ë¡œì˜ ê¸¸ì´ê°€ $dep[u] + dep[v] - dep[lca(u, v)]$ ì™€ ê°™ë‹¤ë©´ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì´ê³  ë‚˜ë¨¸ì§€ ê²½ìš°ëŠ” ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤. ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 2e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 1, n); u = par[ST]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 1, n); int LCA = lca(u, v); ret -= st.query(in[LCA], in[LCA], 1, 1, n); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int p; cin &gt;&gt; p; input[i-1] = {p, i}; inp[p].push_back({1, i}); inp[i].push_back({1, p}); } for(int i=1;i&lt;=n;i++){ st.update(i, 1, 1, 1, n); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n &gt;&gt; q; hld.n = n; hld.precal(); while (q--) { int u, v, o; cin &gt;&gt; u &gt;&gt; v &gt;&gt; o; bool ok = false; if(hld.query(u, v)==hld.dep[u]+hld.dep[v]-2*hld.dep[hld.lca(u, v)]){ ok = true; cout &lt;&lt; &quot;YES\n&quot;; }else{ cout &lt;&lt; &quot;NO\n&quot;; } if(o){ if(ok) hld.st.update(hld.in[u], 0, 1, 1, n); else hld.st.update(hld.in[v], 0, 1, 1, n); } } } 13512 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬3 1ë²ˆ ì¿¼ë¦¬ëŠ” íŠ¸ë¦¬ì˜ ìƒ‰ì„ ë°”ê¾¸ëŠ” ì—°ì‚°ì€ XOR 1ì—°ì‚°ì„ í†µí•´ í•´ê²° í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. 2ë²ˆ ì¿¼ë¦¬ëŠ” 1ë²ˆ ë¶€í„° í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°€ë©´ì„œ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ ì°¾ìœ¼ë©´ ëœë‹¤. 2ë²ˆ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë¬¸ì œì¸ë°â€¦ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ êµ¬í•˜ëŠ” ë°©ë²•ì€ ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•˜ë©´ ëœë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; //Lë¶€í„° ê²€ì‚¬í•˜ëŠ”ê²Œ ì¤‘ìš”!! loëŠ” off-by-one errorë•œì— 1ì„ ëºìŒ if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } ì´ë¥¼ ì´ìš©í•˜ì—¬ êµ¬ê°„ì— 1ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ -1 ë¦¬í„´ êµ¬ê°„ì— ì¡´ì¬í•˜ë©´ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” ê³³ì˜ dfs order ë²ˆí˜¸ë¥¼ ë¦¬í„´í•œë‹¤. ë¬¸ì œëŠ” ê°€ì¥ ë¨¼ì € 1ì´ ë‚˜ì˜¤ëŠ” ê³³ì˜ ì •ì  idxë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— dfs orderingì„ í•  ë•Œ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•´ë†“ëŠ” ê²ƒì´ í¸í•˜ë‹¤. ë‚˜ëŠ” Rì´ë¼ëŠ” ë°°ì—´ì„ ì´ìš©í–ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 1e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] ^= v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; T R[MAXSIZE]; //inì˜ ì—­í•¨ìˆ˜ë¥¼ ì„¤ì •í–ˆìŒ vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; R[tmp] = now; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” 1 T query(T u, T v){ T ret = -1; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; int now = st.bisearch(in[ST], in[u]); if(now&gt;0) ret = now; u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); int now = st.bisearch(in[u], in[v]); if(now&gt;0) ret = now; return ((ret==-1) ? ret : R[ret]); } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int u, v; cin &gt;&gt; u &gt;&gt; v; input[i-1] = {u, v}; inp[u].push_back({1, v}); inp[v].push_back({1, u}); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n; hld.n = n; hld.precal(); cin &gt;&gt; q; while (q--) { int op, v; cin &gt;&gt; op &gt;&gt; v; if(op==1){ hld.st.update(hld.in[v], 1, 1, 1, MAXSIZE); }else{ cout &lt;&lt; hld.query(1, v) &lt;&lt; &#39;\n&#39;; } } } 2927 ë‚¨ê·¹íƒí—˜ ìš°ë¦¬ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ í™•ì •ëœ ìƒíƒœì—ì„œ HLDë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œë¥¼ í’€ì—ˆì§€ë§Œ ì´ ë¬¸ì œëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ ì™„ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì´ëŸ° ê²½ìš° ì™„ì„± ë˜ì—ˆì„ ë•Œì˜ ë¬¸ì œë¡œ ì¹˜í™˜ì„ í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤. ì´ ë•Œ ì˜¤í”„ë¼ì¸ ì¿¼ë¦¬ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ì¼ë‹¨, bridgeì—°ì‚°ì€ Union Findë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ì—°ì‚°ì„ í†µí•´ ë§Œë“¤ì–´ì§„ ê·¸ë˜í”„ëŠ” ë¬´ì¡°ê±´ íŠ¸ë¦¬ í˜•íƒœì´ë‹¤. í•˜ì§€ë§Œ bridgeì—°ì‚°ì´ ì •í™•íˆ n-1ê°œì˜ yesê°€ ë‚˜ì˜¨ë‹¤ëŠ” ë³´ì¥ì´ ì—†ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ íŠ¸ë¦¬ê°€ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ íŠ¸ë¦¬ë¥¼ í•©ì³ì„œ í•˜ë‚˜ì˜ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆì—ˆë‹¤. ì´ì œ excursion ì—°ì‚°ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ì. excursionì€ ì¼ë‹¨ ê¸¸ì´ ì—†ìœ¼ë©´ â€œinpossibleâ€ì„ ì¶œë ¥í•œë‹¤. ê·¼ë° ì´ ê²½ìš°ëŠ” ê·¸ëƒ¥ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œë„ í•´ê²° í•  ìˆ˜ ìˆë‹¤. ë‚˜ë¨¸ì§€ ê¸¸ì´ ìˆëŠ” ê²½ìš°ëŠ” íŠ¸ë¦¬ì—ì„œëŠ” ì •ì  u, v ì‚¬ì´ì˜ ê¸¸ì´ í•˜ë‚˜ ë°–ì— ì—†ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ HLDì´ìš©í•˜ë©´ ëœë‹¤. ê²°ë¡  : â†’ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œ excursionì¤‘ì— ë¶ˆê°€ëŠ¥í•œ ê±°ëŠ” ë¯¸ë¦¬ ê³¨ë¼ ë‘”ë‹¤. â†’ ì´ì œ ì™„ì„±ëœ íŠ¸ë¦¬ë¥¼ ê°€ì§€ê³  ì¿¼ë¦¬ë¥¼ ê±°ê¾¸ë¡œ ë³´ë©´ì„œ ê²½ë¡œ ì¿¼ë¦¬ë¡œ ê¸¸ì´ ìˆëŠ” ê²½ìš°ë¥¼ ê³„ì‚°í•œë‹¤. â†’ penguins ì—°ì‚°ì€ ì—­ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ì‹ìœ¼ë¡œ í•´ì•¼í•œë‹¤. (ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ updateí•˜ë©´ ëœë‹¤. ) ë§ˆì§€ë§‰ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë•Œ bridgeë¼ë©´ ë¯¸ë¦¬ ì €ì¥ëœ 1 â†’ yes 0 â†’ no penguinsë¼ë©´ continue excursionë¼ë©´ Unionfindë¡œ í‰ê°€í–ˆì„ ë•Œ ì´ë¯¸ -1 â†’ â€œimpossibleâ€ ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ query(a, b) ìì„¸í•œê±´ ì•„ë˜ ì½”ë“œì—ì„œ ì£¼ì„ ì²˜ë¦¬ë¡œ ë³´ì´ê² ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 3e4+1; int P[MAXSIZE]; struct DisjointSet{ vector&lt;int&gt; parent, rank; DisjointSet(int n):parent(n+1),rank(n+1, 0){ for(int i=0;i&lt;=n;i++){ parent[i] = i; } } int find(int u){ if(u==parent[u]) return u; return parent[u] = find(parent[u]); } bool merge(int u, int v){ u = find(u); v = find(v); if(u==v) return true; if(rank[u]&gt;rank[v]) swap(u, v); parent[u] = v; if(rank[u]==rank[v]) rank[v]++; return false; } bool check(int u, int v){ u = find(u); v = find(v); if(u==v) return true; return false; } }; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 0){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 0){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = -1; void dfs2(int now = 0){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 0, n); } //u, vê²½ë¡œìƒ í­ê·„ì˜ ìˆ˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 0, MAXSIZE); u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 0, MAXSIZE); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ for(int i=1;i&lt;=n;i++){ inp[0].push_back({1, i}); inp[i].push_back({1, 0}); } top[0] = 1; dfs(); dfs1(); dfs2(); } }; DisjointSet uf(MAXSIZE); HLD&lt;int&gt; hld; class Data{ public: string op; int a, b ,idx, p,q; }; pair&lt;string, int&gt; ans[300005]; int main(){ fast_io int n; cin &gt;&gt; n; hld.n = n; for(int i=1;i&lt;=n;i++) cin &gt;&gt; P[i]; int q; cin &gt;&gt; q; vector&lt;Data&gt; Q(q+1); for(int i=1;i&lt;=q;i++){ string op; int a, b; cin &gt;&gt; op &gt;&gt; a &gt;&gt; b; if(op==&quot;bridge&quot;){ if(uf.merge(a, b)){//ì´ë¯¸ í•©ì³ì ¸ìˆìŒ ans[i] = {&quot;bridge&quot;, 0}; }else{//í•©ì³ì•¼í•¨ ans[i] = {&quot;bridge&quot;, 1}; hld.inp[a].push_back({1, b}); hld.inp[b].push_back({1, a}); } Q[i] = {op, a, b, i, -1, -1}; }else if(op==&quot;penguins&quot;){ Q[i] = {op, a, b, i, P[a], b}; P[a] = b; }else{ if(uf.check(a, b)){ //ì´ë¯¸ í•©ì³ì ¸ ìˆìŒ Q[i] = {op, a, b, i, a, b}; }else{ ans[i] = {&quot;excursion&quot;, -1}; Q[i] = {op, a, b, i, -1, -1}; } } } hld.precal(); //0ì´ ë£¨íŠ¸ì¸ í•˜ë‚˜ì˜ íŠ¸ë¦¬ for(int i=1;i&lt;=n;i++){ //í­ê·„ì„ ê° ì„¬ì— ë„£ì–´ì¤Œ hld.st.update(hld.in[i], P[i], 1, 0, MAXSIZE); } for(int i=q;i&gt;=1;i--){ if(Q[i].op==&quot;bridge&quot;) continue; if(Q[i].op==&quot;penguins&quot;){ hld.st.update(hld.in[Q[i].a], Q[i].p, 1, 0, MAXSIZE); ans[Q[i].idx] = {Q[i].op, 0}; }else{ if(Q[i].p==-1) continue; ans[Q[i].idx] = {Q[i].op, hld.query(Q[i].a, Q[i].b)}; } } for(int i=1;i&lt;=q;i++){ if(ans[i].xx==&quot;bridge&quot;){ if(ans[i].yy) cout &lt;&lt; &quot;yes\n&quot;; else cout &lt;&lt; &quot;no\n&quot;; }else if(ans[i].xx==&quot;penguins&quot;){ continue; }else{ if(ans[i].yy==-1) cout &lt;&lt; &quot;impossible\n&quot;; else cout &lt;&lt; ans[i].yy &lt;&lt; &#39;\n&#39;; } } }" />
<link rel="canonical" href="http://localhost:4000/posts/HLD/" />
<meta property="og:url" content="http://localhost:4000/posts/HLD/" />
<meta property="og:site_name" content="ë„ì‚¬ì˜€ë‹¤ ë¸”ë¡œê·¸" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-05-12T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Heavy-Light decomposition" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-12T00:00:00+09:00","datePublished":"2023-05-12T00:00:00+09:00","description":"HLD(Heavy Light Decomposition) ğŸ’¡ íŠ¸ë¦¬ì—ì„œ ì„ì˜ì˜ ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì— ëŒ€í•œ ì¿¼ë¦¬ê°€ ê¶ê¸ˆí•  ë•Œ. êµ¬í˜„ê³¼ì • êµ¬í˜„ê³¼ì •ì€ jinhanë‹˜ì˜ ë¸”ë¡œê·¸ ë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬í˜„í–ˆë‹¤. ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ê·¸ë˜í”„ë¼ë©´ adjì— ê°€ì¤‘ì¹˜ ì—†ëŠ” ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê³ , cost[ì •ì ]ì— í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°ˆ ë•Œ ë“œëŠ” ë¹„ìš©ì„ ì €ì¥í•œë‹¤. ê·¸ë¦¬ê³  input[i] = {u, v}ì´ëŸ° ì‹ìœ¼ë¡œ ì •ì ì— ë²ˆí˜¸ë¥¼ ë¶™ì—¬ì¤€ë‹¤.(ì„¸ê·¸íŠ¸ë¦¬ë¡œ ë‹¤ë£¨ê¸° ìœ„í•¨) dfs1ì„ ëŒë©´ì„œ ê° ì •ì ì˜ ê¹Šì´(dep), ê° ì •ì ì˜ ë¶€ëª¨ ì •ì (par), ê° ì •ì ì´ ë§Œë“œëŠ” ì„œë¸ŒíŠ¸ë¦¬ í¬ê¸°(sz)ë¥¼ ì €ì¥í•œë‹¤. ì´ ë•Œ adj[ì •ì ][0]ì—ëŠ” ê°€ì¥ ë¬´ê±°ìš´ ê°„ì„ ì´ ë˜ë„ë¡ í•œë‹¤. dfs2ë¥¼ ëŒë©´ì„œ ì˜¤ì¼ëŸ¬íˆ¬ì–´ í…Œí¬ë‹‰ì„ ì ìš©í•˜ê³  ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ ì§€ë‹ˆëŠ” ì •ì ì¸ì§€ë¥¼ ì²´í¬í•œë‹¤. (top) ì •ë¦¬í•´ë³´ë©´ input[i] = ië²ˆì§¸ ì •ì ì€ {xxì •ì , yyì •ì }ë¥¼ ì‡ëŠ” ê°„ì„ ì…ë‹ˆë‹¤. inp[i] : ì§ì ‘ ì…ë ¥ ë°›ì€ ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ì¸ì ‘ ë¦¬ìŠ¤íŠ¸ ê·¸ë˜í”„ adj[i] : inpì„ ë°”ê¿”ì„œ ê°€ì¤‘ì¹˜ë¥¼ ë–¼ì–´ë‚¸ ê·¸ë˜í”„ cost[i] : ië²ˆ ì§¸ ì •ì ê¹Œì§€ ê°€ëŠ”ë° ë“œëŠ” ê°€ì¤‘ì¹˜(ë¹„ìš©) dep, par, szëŠ” ìœ„ì— ì„¤ëª…í–ˆê³  in, out â†’ ì˜¤ì¼ëŸ¬ íˆ¬ì–´ í…Œí¬ë‹‰(DFS ordering)í•˜ê³  ë‚œ ê²°ê³¼ in[ì–´ë–¤ ì •ì ]ì´ ì§€ì¹­í•˜ëŠ” ê°„ì„  ë²ˆí˜¸ top[i] : ië²ˆ ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ë©´ 0 ì•„ë‹ˆë©´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ëŠ” ì •ì ì„ ì €ì¥í•´ë‘ . ì´ì œ ìš°ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì! ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§„ ê°„ì„ ì€ ë¬´ì—‡ì¼ê¹Œ? ì´ ë•Œ, ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ëŠ” ë³€í•  ìˆ˜ ìˆë‹¤. â†’ 13510 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬ ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ê²ƒ ì´ë‹¤. 1 2 3 4 5 6 //update ì—°ì‚° , xstëŠ” maxSegmentTreeì´ë‹¤. // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].xx, input[i].yy); xst.update(in[input[i].xx], val, 1, 1, n); } ìœ„ ì½”ë“œë¥¼ ë³´ë©´ depê°€ ê¹Šì€ ì •ì ì— í•´ë‹¹í•˜ëŠ” ê°„ì„ ì„ valë¡œ ë³€í™”ì‹œí‚¨ë‹¤. 2ë²ˆì— í•´ë‹¹í•˜ëŠ” ì½”ë“œì´ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 //query ì—°ì‚° //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int st = top[u]; ret = max(ret, xst.xquery(in[st], in[u], 1, 1, n)); u = par[st]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); T nxt = -1; for(auto i : adj[u]) if(top[i]==top[u]) nxt = i; ret = max(ret, xst.xquery(in[nxt], in[v], 1, 1, n)); return ret; } ì´ëŠ” 1ë²ˆ - ì¦‰ ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ êµ¬í•˜ëŠ” ì¿¼ë¦¬ì´ë‹¤. top[ì–´ë–¤ ì •ì ]ì€ ê°„ì„  ë¶„ë¥˜ì˜ ë§¨ ìœ„ë¡œ ì˜¬ë¼ê°„ë‹¤ëŠ” ëœ»ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 5 - 7ë¡œ ê°„ë‹¤ê³  í•˜ë©´ 5ë‘ 7ì˜ ê¹Šì´ê°€ ê°™ìœ¼ë‹ˆê¹Œ u = 5, v = 7 uë¥¼ st = top[u] = 2ì´ë‹¤. íŒŒë€ ê°„ì„ ì´ ëë‚˜ëŠ” ì •ì ê¹Œì§€ ê°€ê³  ì´ ë•Œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¡œ ê²½ë¡œ ìƒ íŒŒë€ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤). ë‹¤ìŒì—” u = 7, v = 2ê°€ ë  ê²ƒì´ê³  top[u] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë…¸ë€ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ë‹¤ìŒì—” u = 2, v = 1ì´ ë  ê²ƒì´ê³  top[2] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ ë¹¨ê°„ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤) ì´ëŸ° ì‹ìœ¼ë¡œ ë¬´ê±°ìš´ ê°„ì„ ì„ í†µí•´ ë¶„ë¥˜í•œ ê°„ì„ ìœ¼ë¡œ ì­‰ì­‰ ì´ë™í•˜ë©´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ HLDì´ë‹¤. ì´ë•Œ ì´ ê°„ì„ ì˜ ì¢…ë¥˜ê°€ $logN$ê°œ ì´ë¯€ë¡œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ í•˜ëŠ” $logN$ê³¼ í•©ì³ ì´ ì‹œê°„ ë³µì¡ë„ : $O((logN)^2)$ìœ¼ë¡œ ê° ì¿¼ë¦¬ë¥¼ í•´ê²° í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤. 13309 íŠ¸ë¦¬ íŠ¸ë¦¬ê°€ ê°€ì¤‘ì¹˜ 1ë¡œ ëª¨ë‘ ì—°ê²° ë˜ì–´ìˆë‹¤ê³  í•˜ê³  ì—°ê²°ì´ ëŠì–´ì§€ë©´ updateì—°ì‚°ìœ¼ë¡œ í•´ë‹¹ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ êµ¬í•œ ê²½ë¡œì˜ ê¸¸ì´ê°€ $dep[u] + dep[v] - dep[lca(u, v)]$ ì™€ ê°™ë‹¤ë©´ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì´ê³  ë‚˜ë¨¸ì§€ ê²½ìš°ëŠ” ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤. ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 2e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 1, n); u = par[ST]; } if(u==v) return ret; if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 1, n); int LCA = lca(u, v); ret -= st.query(in[LCA], in[LCA], 1, 1, n); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int p; cin &gt;&gt; p; input[i-1] = {p, i}; inp[p].push_back({1, i}); inp[i].push_back({1, p}); } for(int i=1;i&lt;=n;i++){ st.update(i, 1, 1, 1, n); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n &gt;&gt; q; hld.n = n; hld.precal(); while (q--) { int u, v, o; cin &gt;&gt; u &gt;&gt; v &gt;&gt; o; bool ok = false; if(hld.query(u, v)==hld.dep[u]+hld.dep[v]-2*hld.dep[hld.lca(u, v)]){ ok = true; cout &lt;&lt; &quot;YES\\n&quot;; }else{ cout &lt;&lt; &quot;NO\\n&quot;; } if(o){ if(ok) hld.st.update(hld.in[u], 0, 1, 1, n); else hld.st.update(hld.in[v], 0, 1, 1, n); } } } 13512 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬3 1ë²ˆ ì¿¼ë¦¬ëŠ” íŠ¸ë¦¬ì˜ ìƒ‰ì„ ë°”ê¾¸ëŠ” ì—°ì‚°ì€ XOR 1ì—°ì‚°ì„ í†µí•´ í•´ê²° í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. 2ë²ˆ ì¿¼ë¦¬ëŠ” 1ë²ˆ ë¶€í„° í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°€ë©´ì„œ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ ì°¾ìœ¼ë©´ ëœë‹¤. 2ë²ˆ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë¬¸ì œì¸ë°â€¦ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ êµ¬í•˜ëŠ” ë°©ë²•ì€ ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•˜ë©´ ëœë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; //Lë¶€í„° ê²€ì‚¬í•˜ëŠ”ê²Œ ì¤‘ìš”!! loëŠ” off-by-one errorë•œì— 1ì„ ëºìŒ if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } ì´ë¥¼ ì´ìš©í•˜ì—¬ êµ¬ê°„ì— 1ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ -1 ë¦¬í„´ êµ¬ê°„ì— ì¡´ì¬í•˜ë©´ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” ê³³ì˜ dfs order ë²ˆí˜¸ë¥¼ ë¦¬í„´í•œë‹¤. ë¬¸ì œëŠ” ê°€ì¥ ë¨¼ì € 1ì´ ë‚˜ì˜¤ëŠ” ê³³ì˜ ì •ì  idxë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— dfs orderingì„ í•  ë•Œ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•´ë†“ëŠ” ê²ƒì´ í¸í•˜ë‹¤. ë‚˜ëŠ” Rì´ë¼ëŠ” ë°°ì—´ì„ ì´ìš©í–ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 1e5+1; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] ^= v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } T bisearch(T L, T R){ if(!query(L, R, 1, 1, MAXSIZE)) return -1; T lo = L-1 , hi = R; while(lo+1&lt;hi){ T mid = (lo+hi)&gt;&gt;1; if(query(L, mid, 1, 1, MAXSIZE)){ hi = mid; }else{ lo = mid; } } return hi; } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; T R[MAXSIZE]; //inì˜ ì—­í•¨ìˆ˜ë¥¼ ì„¤ì •í–ˆìŒ vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 1){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 1){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = 0; void dfs2(int now = 1){ in[now] = ++tmp; R[tmp] = now; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 1, n); } //u, vìœ„ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” 1 T query(T u, T v){ T ret = -1; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; int now = st.bisearch(in[ST], in[u]); if(now&gt;0) ret = now; u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); int now = st.bisearch(in[u], in[v]); if(now&gt;0) ret = now; return ((ret==-1) ? ret : R[ret]); } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ input = vector&lt;pair&lt;T, T&gt; &gt; (n+1); for(int i=2;i&lt;=n;i++){ int u, v; cin &gt;&gt; u &gt;&gt; v; input[i-1] = {u, v}; inp[u].push_back({1, v}); inp[v].push_back({1, u}); } top[1] = 1; dfs(); dfs1(); dfs2(); } }; HLD&lt;int&gt; hld; int main(){ fast_io int n, q; cin &gt;&gt; n; hld.n = n; hld.precal(); cin &gt;&gt; q; while (q--) { int op, v; cin &gt;&gt; op &gt;&gt; v; if(op==1){ hld.st.update(hld.in[v], 1, 1, 1, MAXSIZE); }else{ cout &lt;&lt; hld.query(1, v) &lt;&lt; &#39;\\n&#39;; } } } 2927 ë‚¨ê·¹íƒí—˜ ìš°ë¦¬ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ í™•ì •ëœ ìƒíƒœì—ì„œ HLDë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œë¥¼ í’€ì—ˆì§€ë§Œ ì´ ë¬¸ì œëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ ì™„ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì´ëŸ° ê²½ìš° ì™„ì„± ë˜ì—ˆì„ ë•Œì˜ ë¬¸ì œë¡œ ì¹˜í™˜ì„ í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤. ì´ ë•Œ ì˜¤í”„ë¼ì¸ ì¿¼ë¦¬ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ì¼ë‹¨, bridgeì—°ì‚°ì€ Union Findë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ì—°ì‚°ì„ í†µí•´ ë§Œë“¤ì–´ì§„ ê·¸ë˜í”„ëŠ” ë¬´ì¡°ê±´ íŠ¸ë¦¬ í˜•íƒœì´ë‹¤. í•˜ì§€ë§Œ bridgeì—°ì‚°ì´ ì •í™•íˆ n-1ê°œì˜ yesê°€ ë‚˜ì˜¨ë‹¤ëŠ” ë³´ì¥ì´ ì—†ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ íŠ¸ë¦¬ê°€ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ íŠ¸ë¦¬ë¥¼ í•©ì³ì„œ í•˜ë‚˜ì˜ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆì—ˆë‹¤. ì´ì œ excursion ì—°ì‚°ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ì. excursionì€ ì¼ë‹¨ ê¸¸ì´ ì—†ìœ¼ë©´ â€œinpossibleâ€ì„ ì¶œë ¥í•œë‹¤. ê·¼ë° ì´ ê²½ìš°ëŠ” ê·¸ëƒ¥ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œë„ í•´ê²° í•  ìˆ˜ ìˆë‹¤. ë‚˜ë¨¸ì§€ ê¸¸ì´ ìˆëŠ” ê²½ìš°ëŠ” íŠ¸ë¦¬ì—ì„œëŠ” ì •ì  u, v ì‚¬ì´ì˜ ê¸¸ì´ í•˜ë‚˜ ë°–ì— ì—†ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ HLDì´ìš©í•˜ë©´ ëœë‹¤. ê²°ë¡  : â†’ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œ excursionì¤‘ì— ë¶ˆê°€ëŠ¥í•œ ê±°ëŠ” ë¯¸ë¦¬ ê³¨ë¼ ë‘”ë‹¤. â†’ ì´ì œ ì™„ì„±ëœ íŠ¸ë¦¬ë¥¼ ê°€ì§€ê³  ì¿¼ë¦¬ë¥¼ ê±°ê¾¸ë¡œ ë³´ë©´ì„œ ê²½ë¡œ ì¿¼ë¦¬ë¡œ ê¸¸ì´ ìˆëŠ” ê²½ìš°ë¥¼ ê³„ì‚°í•œë‹¤. â†’ penguins ì—°ì‚°ì€ ì—­ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ì‹ìœ¼ë¡œ í•´ì•¼í•œë‹¤. (ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ updateí•˜ë©´ ëœë‹¤. ) ë§ˆì§€ë§‰ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë•Œ bridgeë¼ë©´ ë¯¸ë¦¬ ì €ì¥ëœ 1 â†’ yes 0 â†’ no penguinsë¼ë©´ continue excursionë¼ë©´ Unionfindë¡œ í‰ê°€í–ˆì„ ë•Œ ì´ë¯¸ -1 â†’ â€œimpossibleâ€ ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ query(a, b) ìì„¸í•œê±´ ì•„ë˜ ì½”ë“œì—ì„œ ì£¼ì„ ì²˜ë¦¬ë¡œ ë³´ì´ê² ë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 #include &lt;bits/stdc++.h&gt; #define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false); using namespace std; typedef long long ll; typedef pair&lt;int, int&gt; pii; typedef pair&lt;ll, ll&gt; pll; typedef tuple&lt;int, int, int&gt; tiii; #define xx first #define yy second const int MAXSIZE = 3e4+1; int P[MAXSIZE]; struct DisjointSet{ vector&lt;int&gt; parent, rank; DisjointSet(int n):parent(n+1),rank(n+1, 0){ for(int i=0;i&lt;=n;i++){ parent[i] = i; } } int find(int u){ if(u==parent[u]) return u; return parent[u] = find(parent[u]); } bool merge(int u, int v){ u = find(u); v = find(v); if(u==v) return true; if(rank[u]&gt;rank[v]) swap(u, v); parent[u] = v; if(rank[u]==rank[v]) rank[v]++; return false; } bool check(int u, int v){ u = find(u); v = find(v); if(u==v) return true; return false; } }; // êµ¬ê°„í•© ì„¸ê·¸ template &lt;class T&gt; class Segtree{ public: static const int TREESIZE = 4*MAXSIZE; T* tree = new T[TREESIZE]; Segtree(){ for(int i=0;i&lt;TREESIZE;i++) tree[i] = 0; } ~Segtree(){ delete[] tree; } T update(T x, T v, T node, T S, T E){ if(S==E) return tree[node] = v; // ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ T mid = (S+E)&gt;&gt;1; if(x&lt;=mid) update(x, v, 2*node, S, mid); else update(x, v, 2*node+1, mid+1, E); return tree[node] = tree[2*node]+tree[2*node+1]; } T kth(T node, T S, T E, T K){ if(S==E) return S; T mid = (S+E)&gt;&gt;1; if(tree[2*node]&gt;=K) return kth(2*node, S, mid, K); else return kth(2*node+1, mid+1, E, K-tree[2*node]); } T query(T L, T R, T node, T S, T E){ if(L&gt;E||R&lt;S) return 0; if(L&lt;=S&amp;&amp;E&lt;=R) return tree[node]; T mid = (S+E)&gt;&gt;1; return query(L, R, 2*node, S, mid)+query(L, R, 2*node+1, mid+1, E); } }; // ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸° template &lt;class T&gt; class HLD{ public: int n; T cost[MAXSIZE], sz[MAXSIZE], dep[MAXSIZE], par[MAXSIZE]; T top[MAXSIZE], in[MAXSIZE], out[MAXSIZE]; vector&lt;pair&lt;T, T&gt;&gt; input, inp[MAXSIZE]; vector&lt;T&gt; adj[MAXSIZE]; bool visited[MAXSIZE]; void dfs(int now = 0){ visited[now] = 1; for(auto [ncost, nxt] : inp[now]){ if(visited[nxt]) continue; adj[now].push_back(nxt); cost[nxt] = ncost; dfs(nxt); } } void dfs1(int now = 0){ sz[now] = 1; for(T&amp; nxt : adj[now]){ dep[nxt] = dep[now]+1; par[nxt] = now; dfs1(nxt); sz[now] += sz[nxt]; if(sz[nxt]&gt;sz[adj[now][0]]) swap(nxt, adj[now][0]); //adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy) } } int tmp = -1; void dfs2(int now = 0){ in[now] = ++tmp; for(T nxt : adj[now]){ top[nxt] = (nxt==adj[now][0] ? top[now] : nxt); dfs2(nxt); } out[now] = tmp; } Segtree&lt;T&gt; st; // i ë²ˆ ê°„ì„ ì„ valë¡œ void update(T i, T val){ if(dep[input[i].xx] &lt; dep[input[i].yy]) swap(input[i].yy, input[i].xx); st.update(in[input[i].xx], val, 1, 0, n); } //u, vê²½ë¡œìƒ í­ê·„ì˜ ìˆ˜ T query(T u, T v){ T ret = 0; while(top[u]!=top[v]){ if(dep[top[u]] &lt; dep[top[v]]) swap(u, v); int ST = top[u]; ret += st.query(in[ST], in[u], 1, 0, MAXSIZE); u = par[ST]; } if(dep[u] &gt; dep[v]) swap(u, v); ret += st.query(in[u], in[v], 1, 0, MAXSIZE); return ret; } int lca(int u, int v) { while (top[u] != top[v]) { if (dep[top[u]] &lt; dep[top[v]]) swap(u, v); u = par[top[u]]; } if (dep[u] &gt; dep[v]) swap(u, v); return u; } void precal(){ for(int i=1;i&lt;=n;i++){ inp[0].push_back({1, i}); inp[i].push_back({1, 0}); } top[0] = 1; dfs(); dfs1(); dfs2(); } }; DisjointSet uf(MAXSIZE); HLD&lt;int&gt; hld; class Data{ public: string op; int a, b ,idx, p,q; }; pair&lt;string, int&gt; ans[300005]; int main(){ fast_io int n; cin &gt;&gt; n; hld.n = n; for(int i=1;i&lt;=n;i++) cin &gt;&gt; P[i]; int q; cin &gt;&gt; q; vector&lt;Data&gt; Q(q+1); for(int i=1;i&lt;=q;i++){ string op; int a, b; cin &gt;&gt; op &gt;&gt; a &gt;&gt; b; if(op==&quot;bridge&quot;){ if(uf.merge(a, b)){//ì´ë¯¸ í•©ì³ì ¸ìˆìŒ ans[i] = {&quot;bridge&quot;, 0}; }else{//í•©ì³ì•¼í•¨ ans[i] = {&quot;bridge&quot;, 1}; hld.inp[a].push_back({1, b}); hld.inp[b].push_back({1, a}); } Q[i] = {op, a, b, i, -1, -1}; }else if(op==&quot;penguins&quot;){ Q[i] = {op, a, b, i, P[a], b}; P[a] = b; }else{ if(uf.check(a, b)){ //ì´ë¯¸ í•©ì³ì ¸ ìˆìŒ Q[i] = {op, a, b, i, a, b}; }else{ ans[i] = {&quot;excursion&quot;, -1}; Q[i] = {op, a, b, i, -1, -1}; } } } hld.precal(); //0ì´ ë£¨íŠ¸ì¸ í•˜ë‚˜ì˜ íŠ¸ë¦¬ for(int i=1;i&lt;=n;i++){ //í­ê·„ì„ ê° ì„¬ì— ë„£ì–´ì¤Œ hld.st.update(hld.in[i], P[i], 1, 0, MAXSIZE); } for(int i=q;i&gt;=1;i--){ if(Q[i].op==&quot;bridge&quot;) continue; if(Q[i].op==&quot;penguins&quot;){ hld.st.update(hld.in[Q[i].a], Q[i].p, 1, 0, MAXSIZE); ans[Q[i].idx] = {Q[i].op, 0}; }else{ if(Q[i].p==-1) continue; ans[Q[i].idx] = {Q[i].op, hld.query(Q[i].a, Q[i].b)}; } } for(int i=1;i&lt;=q;i++){ if(ans[i].xx==&quot;bridge&quot;){ if(ans[i].yy) cout &lt;&lt; &quot;yes\\n&quot;; else cout &lt;&lt; &quot;no\\n&quot;; }else if(ans[i].xx==&quot;penguins&quot;){ continue; }else{ if(ans[i].yy==-1) cout &lt;&lt; &quot;impossible\\n&quot;; else cout &lt;&lt; ans[i].yy &lt;&lt; &#39;\\n&#39;; } } }","headline":"Heavy-Light decomposition","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/HLD/"},"url":"http://localhost:4000/posts/HLD/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Heavy-Light decomposition | ë„ì‚¬ì˜€ë‹¤ ë¸”ë¡œê·¸
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">



  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Custom Style -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/image/gotprofile.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">ë„ì‚¬ì˜€ë‹¤ ë¸”ë¡œê·¸</a>
    <p class="site-subtitle fst-italic mb-0">Algorithm & SAP Trouble Shooter</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>

    <!-- ì¹´í…Œê³ ë¦¬ íŠ¸ë¦¬ (Notion Style) ì¶”ê°€ -->
    <div class="sidebar-category-tree mt-4">
      <h5 class="sidebar-heading ps-3 text-muted" style="font-size: 0.9rem; text-transform: uppercase;">ğŸ“š Posts</h5>
      <ul class="nav flex-column">
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Problem Solving</span>
              <span class="badge bg-secondary rounded-pill">33</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B8%B0/" style="font-size: 0.85rem; padding-left: 2rem;">
                    2026-02-22 ë¬¸ì œí’€ì´
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/aho-corasick/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ë¬¸ìì—´ - ì•„í˜¸ ì½”ë¼ì‹(Aho-Corasick)
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/2060-%EC%97%BC%EC%86%8C%EC%A4%84%EC%84%9C%EA%B8%B0-%ED%92%80%EC%9D%B4/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì—¼ì†Œì¤„ì„œê¸° ë¬¸ì œ í’€ì´
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%B6%84%ED%95%A0%EC%A0%95%EB%B3%B5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%B5%9C%EC%A0%81%ED%99%94(Divide-&-Conquer-Optimization)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    D&C Optimization
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/HLD/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Heavy-Light decomposition
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%ED%96%89%EB%A0%AC%EA%B1%B0%EB%93%AD%EC%A0%9C%EA%B3%B1/" style="font-size: 0.85rem; padding-left: 2rem;">
                    í–‰ë ¬ ê±°ë“­ì œê³±
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%98%88%EC%A0%84%EC%97%90-%ED%96%88%EB%8D%98-%EC%97%B0%EC%8A%B5/" style="font-size: 0.85rem; padding-left: 2rem;">
                    SUAPC ì—°ìŠµ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Prefix-Sum/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Prefix Sum ë¬¸ì œ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/SOS/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Sum Over Subsets
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/ETT/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ETT + Segment Tree
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segtree+KMP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree+KMP
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Greedy/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Greedy
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/SCC/" style="font-size: 0.85rem; padding-left: 2rem;">
                    SCC
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/LCA/" style="font-size: 0.85rem; padding-left: 2rem;">
                    LCA
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/2-SAT/" style="font-size: 0.85rem; padding-left: 2rem;">
                    2-SAT
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Hash/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Hashing
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree3/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree ì‘ìš©
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Divide&Conquer/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Divide & Conquer
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Tree-DP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Tree DP
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Topological-Sort/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Topological Sort
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Trie/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Trie
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/MergeSort/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Merge Sort
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree2/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree - êµ¬ê°„ê°±ì‹ 
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/KMP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    KMPì˜ Partial Match Table
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/MST&Prim_Algorithm/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Prim Algorithm optimazation
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/DisjointSet/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Disjoint Set
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/BFS-%EC%B5%9C%EB%8B%A8%EA%B1%B0%EB%A6%AC(%EB%B0%B1%EC%A4%80-2206-%EB%B2%BD-%EB%B6%80%EC%88%98%EA%B3%A0-%EC%9D%B4%EB%8F%99%ED%95%98%EA%B8%B0)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    BFS
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%8B%A4%EA%B0%81%ED%98%95%EC%9D%98-%EB%A9%B4%EC%A0%81(%EB%B0%B1%EC%A4%80-2166-%EB%8B%A4%EA%B0%81%ED%98%95%EC%9D%98-%EB%A9%B4%EC%A0%81-)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê¸°í•˜
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9D%B4%EB%B6%84%ED%83%90%EC%83%89(%EB%B0%B1%EC%A4%80-12015-%EA%B0%80%EC%9E%A5-%EA%B8%B4-%EC%A6%9D%EA%B0%80%ED%95%98%EB%8A%94-%EB%B6%80%EB%B6%84-%EC%88%98%EC%97%B42)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì´ë¶„íƒìƒ‰
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%88%84%EC%A0%81%ED%95%A9(%EB%B0%B1%EC%A4%80-10986-%EB%82%98%EB%A8%B8%EC%A7%80-%ED%95%A9)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ëˆ„ì  í•©
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/stack/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Stack
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Sorting1/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì •ë ¬1
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Algorithm</span>
              <span class="badge bg-secondary rounded-pill">32</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/aho-corasick/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ë¬¸ìì—´ - ì•„í˜¸ ì½”ë¼ì‹(Aho-Corasick)
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/2060-%EC%97%BC%EC%86%8C%EC%A4%84%EC%84%9C%EA%B8%B0-%ED%92%80%EC%9D%B4/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì—¼ì†Œì¤„ì„œê¸° ë¬¸ì œ í’€ì´
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%B6%84%ED%95%A0%EC%A0%95%EB%B3%B5%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%B5%9C%EC%A0%81%ED%99%94(Divide-&-Conquer-Optimization)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    D&C Optimization
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/HLD/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Heavy-Light decomposition
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%ED%96%89%EB%A0%AC%EA%B1%B0%EB%93%AD%EC%A0%9C%EA%B3%B1/" style="font-size: 0.85rem; padding-left: 2rem;">
                    í–‰ë ¬ ê±°ë“­ì œê³±
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%98%88%EC%A0%84%EC%97%90-%ED%96%88%EB%8D%98-%EC%97%B0%EC%8A%B5/" style="font-size: 0.85rem; padding-left: 2rem;">
                    SUAPC ì—°ìŠµ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Prefix-Sum/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Prefix Sum ë¬¸ì œ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/SOS/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Sum Over Subsets
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/ETT/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ETT + Segment Tree
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segtree+KMP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree+KMP
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Greedy/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Greedy
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/SCC/" style="font-size: 0.85rem; padding-left: 2rem;">
                    SCC
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/LCA/" style="font-size: 0.85rem; padding-left: 2rem;">
                    LCA
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/2-SAT/" style="font-size: 0.85rem; padding-left: 2rem;">
                    2-SAT
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Hash/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Hashing
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree3/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree ì‘ìš©
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Divide&Conquer/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Divide & Conquer
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Tree-DP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Tree DP
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Topological-Sort/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Topological Sort
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Trie/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Trie
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/MergeSort/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Merge Sort
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree2/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree - êµ¬ê°„ê°±ì‹ 
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Segment-Tree/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Segment Tree
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/KMP/" style="font-size: 0.85rem; padding-left: 2rem;">
                    KMPì˜ Partial Match Table
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/MST&Prim_Algorithm/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Prim Algorithm optimazation
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/DisjointSet/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Disjoint Set
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/BFS-%EC%B5%9C%EB%8B%A8%EA%B1%B0%EB%A6%AC(%EB%B0%B1%EC%A4%80-2206-%EB%B2%BD-%EB%B6%80%EC%88%98%EA%B3%A0-%EC%9D%B4%EB%8F%99%ED%95%98%EA%B8%B0)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    BFS
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%8B%A4%EA%B0%81%ED%98%95%EC%9D%98-%EB%A9%B4%EC%A0%81(%EB%B0%B1%EC%A4%80-2166-%EB%8B%A4%EA%B0%81%ED%98%95%EC%9D%98-%EB%A9%B4%EC%A0%81-)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê¸°í•˜
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9D%B4%EB%B6%84%ED%83%90%EC%83%89(%EB%B0%B1%EC%A4%80-12015-%EA%B0%80%EC%9E%A5-%EA%B8%B4-%EC%A6%9D%EA%B0%80%ED%95%98%EB%8A%94-%EB%B6%80%EB%B6%84-%EC%88%98%EC%97%B42)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì´ë¶„íƒìƒ‰
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%88%84%EC%A0%81%ED%95%A9(%EB%B0%B1%EC%A4%80-10986-%EB%82%98%EB%A8%B8%EC%A7%80-%ED%95%A9)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ëˆ„ì  í•©
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/stack/" style="font-size: 0.85rem; padding-left: 2rem;">
                    Stack
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Sorting1/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì •ë ¬1
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Competitive Programming</span>
              <span class="badge bg-secondary rounded-pill">17</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-Round-936(Div.2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë‹¤ì‹œ ë§˜ ì¡ê¸°
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces_Blue/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ë¸”ë£¨ ë‹¬ì•˜ë‹¤!
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/ICPCsinchonSummer/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ICPC sinchon 2023 ì—¬ë¦„ ìº í”„ í›„ê¸°
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Edu-Codeforce-round-149-(Div-2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—°ìŠµì¤‘2
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Edu-Codeforce-round-148-(Div-2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—°ìŠµì¤‘1
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforceround-868(Div2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ìƒˆë¡œ ì‹œì‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-846,-TypeDB-Foreces-2023/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë¸”ë£¨ ì¢€ ê°€ì
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-828,-EDU-137/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì ìˆ˜ê°€ ê³„ì† í•˜ë½ ì¤‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-823,-824/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì‹¤ë ¥ì´ ì•ˆëŠ˜ì–´ ã… ã… 
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/AtCoder-Beginner-Contest-270/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì•³ì½”ë” - ì²«  ì•³ì½”ë”
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-811,-812,codeTon/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - 3ì†”ì˜ ë²½ ê¹¼ë‹¤!
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-808/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—…ì†”ë¹™ ëª°ì•„ì„œ í•¨
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-807/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë˜ 3ì†”ì˜ ë²½
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-805-806/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ìµìˆ™í•´ì§€ëŠ” ì¤‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-131Edu/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë‚˜ëŠ” ë°”ë³´ë‹¤
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-801,-802/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - 3ì†”ì˜ ë²½
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-800/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ í­ë§ ê¸°ë…
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>codeforce</span>
              <span class="badge bg-secondary rounded-pill">14</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-Round-936(Div.2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë‹¤ì‹œ ë§˜ ì¡ê¸°
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Edu-Codeforce-round-149-(Div-2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—°ìŠµì¤‘2
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Edu-Codeforce-round-148-(Div-2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—°ìŠµì¤‘1
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforceround-868(Div2)/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ìƒˆë¡œ ì‹œì‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-846,-TypeDB-Foreces-2023/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë¸”ë£¨ ì¢€ ê°€ì
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-828,-EDU-137/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì ìˆ˜ê°€ ê³„ì† í•˜ë½ ì¤‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-823,-824/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì‹¤ë ¥ì´ ì•ˆëŠ˜ì–´ ã… ã… 
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-811,-812,codeTon/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - 3ì†”ì˜ ë²½ ê¹¼ë‹¤!
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-808/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ì—…ì†”ë¹™ ëª°ì•„ì„œ í•¨
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-807/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë˜ 3ì†”ì˜ ë²½
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-805-806/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ìµìˆ™í•´ì§€ëŠ” ì¤‘
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-131Edu/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - ë‚˜ëŠ” ë°”ë³´ë‹¤
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-801,-802/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ - 3ì†”ì˜ ë²½
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces-800/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì½”ë“œí¬ìŠ¤ í­ë§ ê¸°ë…
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Other Things</span>
              <span class="badge bg-secondary rounded-pill">5</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EA%B7%BC%ED%99%A9-%EB%B0%8F-%EA%B3%84%ED%9A%8D/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê·¼í™© í† í¬ ë° ì•ìœ¼ë¡œì˜ ë¸”ë¡œê·¸ ìš´ì˜ê³„íš
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/It-takes-two-%EA%B2%8C%EC%9E%84%EB%A6%AC%EB%B7%B0/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - It takes two
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9A%A9%EA%B3%BC%EA%B0%99%EC%9D%B4-%EC%A0%9C%EB%A1%9C,-%EA%B7%B92/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - ìš©ê³¼ê°™ì´ ì œë¡œ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9A%A9%EA%B3%BC%EA%B0%99%EC%9D%B4-%EA%B7%B91/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - ìš©ê³¼ê°™ì´ ê·¹ 1
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Persona-5/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - í˜ë¥´ì†Œë‚˜ 5 ë” ë¡œì—´
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>gameReview</span>
              <span class="badge bg-secondary rounded-pill">4</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/It-takes-two-%EA%B2%8C%EC%9E%84%EB%A6%AC%EB%B7%B0/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - It takes two
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9A%A9%EA%B3%BC%EA%B0%99%EC%9D%B4-%EC%A0%9C%EB%A1%9C,-%EA%B7%B92/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - ìš©ê³¼ê°™ì´ ì œë¡œ
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EC%9A%A9%EA%B3%BC%EA%B0%99%EC%9D%B4-%EA%B7%B91/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - ìš©ê³¼ê°™ì´ ê·¹ 1
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Persona-5/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê²Œì„ ë¦¬ë·° - í˜ë¥´ì†Œë‚˜ 5 ë” ë¡œì—´
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Atcoder</span>
              <span class="badge bg-secondary rounded-pill">1</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/AtCoder-Beginner-Contest-270/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ì•³ì½”ë” - ì²«  ì•³ì½”ë”
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Contest</span>
              <span class="badge bg-secondary rounded-pill">2</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/Codeforces_Blue/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ë¸”ë£¨ ë‹¬ì•˜ë‹¤!
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/ICPCsinchonSummer/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ICPC sinchon 2023 ì—¬ë¦„ ìº í”„ í›„ê¸°
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Computer Science</span>
              <span class="badge bg-secondary rounded-pill">2</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/docker-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0/" style="font-size: 0.85rem; padding-left: 2rem;">
                    docker ì´í•´í•´ë³´ê¸°
                  </a>
                </li>
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/1.-rust-%EA%B8%B0%EB%B3%B8-%EB%AC%B8%EB%B2%95/" style="font-size: 0.85rem; padding-left: 2rem;">
                    rust ë¬¸ë²• ê³µë¶€
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>rust</span>
              <span class="badge bg-secondary rounded-pill">1</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/1.-rust-%EA%B8%B0%EB%B3%B8-%EB%AC%B8%EB%B2%95/" style="font-size: 0.85rem; padding-left: 2rem;">
                    rust ë¬¸ë²• ê³µë¶€
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>Just Chatting</span>
              <span class="badge bg-secondary rounded-pill">1</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EA%B7%BC%ED%99%A9-%EB%B0%8F-%EA%B3%84%ED%9A%8D/" style="font-size: 0.85rem; padding-left: 2rem;">
                    ê·¼í™© í† í¬ ë° ì•ìœ¼ë¡œì˜ ë¸”ë¡œê·¸ ìš´ì˜ê³„íš
                  </a>
                </li>
              
            </ul>
          </li>
        
          <li class="nav-item">
            <!-- ì¹´í…Œê³ ë¦¬ ì´ë¦„ (í´ë”ì²˜ëŸ¼) -->
            <a class="nav-link category-trigger" href="#" style="padding-left: 1.5rem; display: flex; justify-content: space-between; align-items: center;">
              <span>BOJ</span>
              <span class="badge bg-secondary rounded-pill">1</span>
            </a>
            <!-- í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ ëª©ë¡ -->
            <ul class="nav flex-column sub-menu" style="display: none; padding-left: 1rem; background: rgba(0,0,0,0.1);">
              
                <li class="nav-item">
                  <a class="nav-link" href="/posts/%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B8%B0/" style="font-size: 0.85rem; padding-left: 2rem;">
                    2026-02-22 ë¬¸ì œí’€ì´
                  </a>
                </li>
              
            </ul>
          </li>
        
      </ul>
    </div>

    <!-- ê°„ë‹¨í•œ í† ê¸€ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        var triggers = document.querySelectorAll('.category-trigger');
        if (triggers) {
          triggers.forEach(function(trigger) {
            trigger.addEventListener('click', function(e) {
              e.preventDefault();
              var subMenu = e.target.closest('.nav-item').querySelector('.sub-menu');
              if (subMenu) {
                subMenu.style.display = subMenu.style.display === 'none' ? 'block' : 'none';
              }
            });
          });
        }
      });
    </script>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/Dosawasseungjun"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    

      
        <a
          href="javascript:location.href = 'mailto:' + ['dosaseung','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Heavy-Light decomposition</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Heavy-Light decomposition</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1683817200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May 12, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://github.com/Dosawasseungjun">Han Seungjun</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4247 words"
>
  <em>23 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Heavy-Light decomposition</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Heavy-Light decomposition</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h1 id="hldheavy-light-decomposition">HLD(Heavy Light Decomposition)</h1>

<aside>
ğŸ’¡ íŠ¸ë¦¬ì—ì„œ ì„ì˜ì˜ ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì— ëŒ€í•œ ì¿¼ë¦¬ê°€ ê¶ê¸ˆí•  ë•Œ.

</aside>

<h2 id="êµ¬í˜„ê³¼ì •"><span class="me-2">êµ¬í˜„ê³¼ì •</span><a href="#êµ¬í˜„ê³¼ì •" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>êµ¬í˜„ê³¼ì •ì€ <a href="https://blog.naver.com/jinhan814/222144994173">jinhanë‹˜ì˜ ë¸”ë¡œê·¸</a> ë¥¼ ì°¸ê³ í•˜ì—¬ êµ¬í˜„í–ˆë‹¤.</p>

<ol>
  <li>ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ê·¸ë˜í”„ë¼ë©´ adjì— ê°€ì¤‘ì¹˜ ì—†ëŠ” ê·¸ë˜í”„ë¥¼ ë§Œë“¤ê³ , cost[ì •ì ]ì— í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°ˆ ë•Œ ë“œëŠ” ë¹„ìš©ì„ ì €ì¥í•œë‹¤. ê·¸ë¦¬ê³  i<strong>nput[i] = {u, v}ì´ëŸ° ì‹ìœ¼ë¡œ ì •ì ì— ë²ˆí˜¸ë¥¼ ë¶™ì—¬ì¤€ë‹¤.</strong>(ì„¸ê·¸íŠ¸ë¦¬ë¡œ ë‹¤ë£¨ê¸° ìœ„í•¨)</li>
  <li>dfs1ì„ ëŒë©´ì„œ <strong>ê° ì •ì ì˜ ê¹Šì´(dep), ê° ì •ì ì˜ ë¶€ëª¨ ì •ì (par), ê° ì •ì ì´ ë§Œë“œëŠ” ì„œë¸ŒíŠ¸ë¦¬ í¬ê¸°(sz)</strong>ë¥¼ ì €ì¥í•œë‹¤. ì´ ë•Œ adj[ì •ì ][0]ì—ëŠ” ê°€ì¥ ë¬´ê±°ìš´ ê°„ì„ ì´ ë˜ë„ë¡ í•œë‹¤.</li>
  <li>dfs2ë¥¼ ëŒë©´ì„œ <strong>ì˜¤ì¼ëŸ¬íˆ¬ì–´ í…Œí¬ë‹‰</strong>ì„ ì ìš©í•˜ê³  <strong>ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ ì§€ë‹ˆëŠ” ì •ì ì¸ì§€ë¥¼ ì²´í¬í•œë‹¤. (top)</strong></li>
</ol>

<p>ì •ë¦¬í•´ë³´ë©´</p>

<ul>
  <li>input[i] = ië²ˆì§¸ ì •ì ì€ {xxì •ì , yyì •ì }ë¥¼ ì‡ëŠ” ê°„ì„ ì…ë‹ˆë‹¤.</li>
  <li>inp[i] : ì§ì ‘ ì…ë ¥ ë°›ì€ ê°€ì¤‘ì¹˜ê°€ ìˆëŠ” ì¸ì ‘ ë¦¬ìŠ¤íŠ¸ ê·¸ë˜í”„</li>
  <li>adj[i] : inpì„ ë°”ê¿”ì„œ ê°€ì¤‘ì¹˜ë¥¼ ë–¼ì–´ë‚¸ ê·¸ë˜í”„</li>
  <li>cost[i] : ië²ˆ ì§¸ ì •ì ê¹Œì§€ ê°€ëŠ”ë° ë“œëŠ” ê°€ì¤‘ì¹˜(ë¹„ìš©)</li>
  <li>dep, par, szëŠ” ìœ„ì— ì„¤ëª…í–ˆê³ </li>
  <li>in, out â†’ ì˜¤ì¼ëŸ¬ íˆ¬ì–´ í…Œí¬ë‹‰(DFS ordering)í•˜ê³  ë‚œ ê²°ê³¼ in[ì–´ë–¤ ì •ì ]ì´  ì§€ì¹­í•˜ëŠ” ê°„ì„  ë²ˆí˜¸</li>
  <li>top[i] : ië²ˆ ì •ì ì´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ë©´ 0 ì•„ë‹ˆë©´ ë¬´ê±°ìš´ ê°„ì„ ì„ í¬í•¨í•˜ëŠ” ì •ì ì„ ì €ì¥í•´ë‘ .</li>
</ul>

<p>ì´ì œ ìš°ë¦¬ì˜ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì!</p>

<ol>
  <li>ë‘ ì •ì ì„ ì‡ëŠ” ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ê°€ì§„ ê°„ì„ ì€ ë¬´ì—‡ì¼ê¹Œ?</li>
  <li>ì´ ë•Œ, ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ëŠ” ë³€í•  ìˆ˜ ìˆë‹¤.  â†’ <a href="https://www.acmicpc.net/problem/13510">13510 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬</a></li>
</ol>

<p>ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ê²ƒ ì´ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1">//update ì—°ì‚° , xstëŠ” maxSegmentTreeì´ë‹¤.</span>
<span class="c1">// i ë²ˆ ê°„ì„ ì„ valë¡œ</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="n">val</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">);</span>
        <span class="n">xst</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>ìœ„ ì½”ë“œë¥¼ ë³´ë©´ depê°€ ê¹Šì€ ì •ì ì— í•´ë‹¹í•˜ëŠ” ê°„ì„ ì„ valë¡œ ë³€í™”ì‹œí‚¨ë‹¤.  2ë²ˆì— í•´ë‹¹í•˜ëŠ” ì½”ë“œì´ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1">//query ì—°ì‚°</span>
<span class="c1">//u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">T</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">!=</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">st</span> <span class="o">=</span> <span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">xst</span><span class="p">.</span><span class="n">xquery</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">st</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">));</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">st</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="n">T</span> <span class="n">nxt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="n">i</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="k">if</span><span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">xst</span><span class="p">.</span><span class="n">xquery</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">nxt</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>ì´ëŠ” 1ë²ˆ - ì¦‰ ê²½ë¡œì—ì„œ ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ êµ¬í•˜ëŠ” ì¿¼ë¦¬ì´ë‹¤.</p>

<p><a href="/assets/image/HLD.jpeg" class="popup img-link shimmer"><img src="/assets/image/HLD.jpeg" alt="HLD.jpeg" loading="lazy"></a></p>

<p>top[ì–´ë–¤ ì •ì ]ì€ ê°„ì„  ë¶„ë¥˜ì˜ ë§¨ ìœ„ë¡œ ì˜¬ë¼ê°„ë‹¤ëŠ” ëœ»ì´ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ 5 - 7ë¡œ ê°„ë‹¤ê³  í•˜ë©´</p>

<ol>
  <li>5ë‘ 7ì˜ ê¹Šì´ê°€ ê°™ìœ¼ë‹ˆê¹Œ u = 5, v = 7</li>
  <li>uë¥¼ st = top[u] = 2ì´ë‹¤.  íŒŒë€ ê°„ì„ ì´ ëë‚˜ëŠ” ì •ì ê¹Œì§€ ê°€ê³ </li>
  <li>ì´ ë•Œ <strong>ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¡œ ê²½ë¡œ ìƒ íŒŒë€ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤).</strong></li>
  <li>ë‹¤ìŒì—” u = 7, v = 2ê°€ ë  ê²ƒì´ê³  top[u] = 1ì´ë‹¤. â†’ ê²½ë¡œ ìƒ <strong>ë…¸ë€ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤)</strong></li>
  <li>ë‹¤ìŒì—” u = 2, v = 1ì´ ë  ê²ƒì´ê³  top[2] = 1ì´ë‹¤. â†’ <strong>ê²½ë¡œ ìƒ ë¹¨ê°„ ê°„ì„ ì„ ëª¨ë‘ ë”í•œë‹¤.(ìµœëŒ€ê°’ì„ ì°¾ëŠ”ë‹¤)</strong></li>
</ol>

<p>ì´ëŸ° ì‹ìœ¼ë¡œ ë¬´ê±°ìš´ ê°„ì„ ì„ í†µí•´ ë¶„ë¥˜í•œ ê°„ì„ ìœ¼ë¡œ ì­‰ì­‰ ì´ë™í•˜ë©´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ HLDì´ë‹¤.</p>

<p>ì´ë•Œ ì´ ê°„ì„ ì˜ ì¢…ë¥˜ê°€ $logN$ê°œ ì´ë¯€ë¡œ ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ë¥¼ í•˜ëŠ” $logN$ê³¼ í•©ì³</p>

<p>ì´ ì‹œê°„ ë³µì¡ë„ : $O((logN)^2)$ìœ¼ë¡œ ê° ì¿¼ë¦¬ë¥¼ í•´ê²° í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</p>

<h3 id="13309-íŠ¸ë¦¬"><span class="me-2"><a href="https://www.acmicpc.net/problem/13309">13309 íŠ¸ë¦¬</a></span><a href="#13309-íŠ¸ë¦¬" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>íŠ¸ë¦¬ê°€ ê°€ì¤‘ì¹˜ 1ë¡œ ëª¨ë‘ ì—°ê²° ë˜ì–´ìˆë‹¤ê³  í•˜ê³  ì—°ê²°ì´ ëŠì–´ì§€ë©´ updateì—°ì‚°ìœ¼ë¡œ í•´ë‹¹ê°„ì„ ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. ê·¸ë¦¬ê³ ë‚˜ì„œ êµ¬í•œ ê²½ë¡œì˜ ê¸¸ì´ê°€ $dep[u] + dep[v] - dep[lca(u, v)]$ ì™€ ê°™ë‹¤ë©´ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì´ê³  ë‚˜ë¨¸ì§€ ê²½ìš°ëŠ” ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤.</p>

<p>ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false);
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span> <span class="n">ll</span><span class="o">&gt;</span> <span class="n">pll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">tiii</span><span class="p">;</span>
<span class="cp">#define xx first
#define yy second
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXSIZE</span> <span class="o">=</span> <span class="mf">2e5</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

<span class="c1">// êµ¬ê°„í•© ì„¸ê·¸</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Segtree</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">TREESIZE</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">MAXSIZE</span><span class="p">;</span>
    <span class="n">T</span><span class="o">*</span> <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">TREESIZE</span><span class="p">];</span>

    <span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">TREESIZE</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">~</span><span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">delete</span><span class="p">[]</span> <span class="n">tree</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="c1">// ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ</span>
        
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
        <span class="k">else</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">kth</span><span class="p">(</span><span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="n">K</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">K</span><span class="p">)</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span>
        <span class="k">else</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;</span><span class="n">E</span><span class="o">||</span><span class="n">R</span><span class="o">&lt;</span><span class="n">S</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&lt;=</span><span class="n">S</span><span class="o">&amp;&amp;</span><span class="n">E</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">];</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span><span class="o">+</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="c1">// ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸°</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">HLD</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">T</span> <span class="n">cost</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">dep</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">T</span> <span class="n">top</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">input</span><span class="p">,</span> <span class="n">inp</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">bool</span> <span class="n">visited</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">ncost</span><span class="p">,</span> <span class="n">nxt</span><span class="p">]</span> <span class="o">:</span> <span class="n">inp</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">nxt</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">cost</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncost</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">dep</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">now</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">par</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
            <span class="n">dfs1</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span><span class="o">&gt;</span><span class="n">sz</span><span class="p">[</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">nxt</span><span class="p">,</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">in</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tmp</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">top</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nxt</span><span class="o">==</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="n">top</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">:</span> <span class="n">nxt</span><span class="p">);</span>
            <span class="n">dfs2</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">out</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">Segtree</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
    
    <span class="c1">// i ë²ˆ ê°„ì„ ì„ valë¡œ</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="n">val</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">//u, vìœ„ ê°€ì¥ í° ê°€ì¤‘ì¹˜</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">T</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">!=</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">ST</span> <span class="o">=</span> <span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">ST</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">ST</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="n">ret</span> <span class="o">+=</span> <span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">LCA</span> <span class="o">=</span> <span class="n">lca</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="n">ret</span> <span class="o">-=</span> <span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">LCA</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">LCA</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="nf">lca</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">precal</span><span class="p">(){</span>
        <span class="n">input</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">p</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">p</span><span class="p">;</span>
            <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">};</span>
            <span class="n">inp</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
            <span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">top</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">();</span> <span class="n">dfs1</span><span class="p">();</span> <span class="n">dfs2</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">HLD</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">hld</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">fast_io</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">hld</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">hld</span><span class="p">.</span><span class="n">precal</span><span class="p">();</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">o</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">o</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">ok</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="n">hld</span><span class="p">.</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="n">hld</span><span class="p">.</span><span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">hld</span><span class="p">.</span><span class="n">dep</span><span class="p">[</span><span class="n">hld</span><span class="p">.</span><span class="n">lca</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)]){</span>
            <span class="n">ok</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"YES</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"NO</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">o</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span> <span class="n">hld</span><span class="p">.</span><span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
            <span class="k">else</span> <span class="n">hld</span><span class="p">.</span><span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>
        
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="13512-íŠ¸ë¦¬ì™€-ì¿¼ë¦¬3"><span class="me-2"><a href="https://www.acmicpc.net/problem/13512">13512 íŠ¸ë¦¬ì™€ ì¿¼ë¦¬3</a></span><a href="#13512-íŠ¸ë¦¬ì™€-ì¿¼ë¦¬3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ol>
  <li>1ë²ˆ ì¿¼ë¦¬ëŠ” íŠ¸ë¦¬ì˜ ìƒ‰ì„ ë°”ê¾¸ëŠ” ì—°ì‚°ì€ XOR 1ì—°ì‚°ì„ í†µí•´ í•´ê²° í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</li>
  <li>2ë²ˆ ì¿¼ë¦¬ëŠ” 1ë²ˆ ë¶€í„° í•´ë‹¹ ì •ì ìœ¼ë¡œ ê°€ë©´ì„œ ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ ì°¾ìœ¼ë©´ ëœë‹¤.</li>
</ol>

<p>2ë²ˆ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë¬¸ì œì¸ë°â€¦</p>

<p>ê°€ì¥ ë¨¼ì € ë‚˜ì˜¤ëŠ” 1ì„ êµ¬í•˜ëŠ” ë°©ë²•ì€ ì´ë¶„ íƒìƒ‰ì„ ì´ìš©í•˜ë©´ ëœë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">T</span> <span class="nf">bisearch</span><span class="p">(</span><span class="n">T</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="n">R</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">))</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">lo</span> <span class="o">=</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">lo</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">hi</span><span class="p">){</span>
            <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span><span class="o">+</span><span class="n">hi</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">//Lë¶€í„° ê²€ì‚¬í•˜ëŠ”ê²Œ ì¤‘ìš”!! loëŠ” off-by-one errorë•œì— 1ì„ ëºìŒ</span>
            <span class="k">if</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">)){</span>
                <span class="n">hi</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">lo</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">hi</span><span class="p">;</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>ì´ë¥¼ ì´ìš©í•˜ì—¬ êµ¬ê°„ì— 1ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ë°”ë¡œ -1 ë¦¬í„´</p>

<p>êµ¬ê°„ì— ì¡´ì¬í•˜ë©´ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” ê³³ì˜ dfs order ë²ˆí˜¸ë¥¼ ë¦¬í„´í•œë‹¤.</p>

<p>ë¬¸ì œëŠ” ê°€ì¥ ë¨¼ì € 1ì´ ë‚˜ì˜¤ëŠ” ê³³ì˜ ì •ì  idxë¥¼ ì¶œë ¥í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— dfs orderingì„ í•  ë•Œ ì—­í•¨ìˆ˜ë¥¼ êµ¬í•´ë†“ëŠ” ê²ƒì´ í¸í•˜ë‹¤.  ë‚˜ëŠ” Rì´ë¼ëŠ” ë°°ì—´ì„ ì´ìš©í–ˆë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false);
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span> <span class="n">ll</span><span class="o">&gt;</span> <span class="n">pll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">tiii</span><span class="p">;</span>
<span class="cp">#define xx first
#define yy second
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXSIZE</span> <span class="o">=</span> <span class="mf">1e5</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

<span class="c1">// êµ¬ê°„í•© ì„¸ê·¸</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Segtree</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">TREESIZE</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">MAXSIZE</span><span class="p">;</span>
    <span class="n">T</span><span class="o">*</span> <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">TREESIZE</span><span class="p">];</span>

    <span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">TREESIZE</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">~</span><span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">delete</span><span class="p">[]</span> <span class="n">tree</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">^=</span> <span class="n">v</span><span class="p">;</span> <span class="c1">// ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ</span>
        
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
        <span class="k">else</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">kth</span><span class="p">(</span><span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="n">K</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">K</span><span class="p">)</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span>
        <span class="k">else</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;</span><span class="n">E</span><span class="o">||</span><span class="n">R</span><span class="o">&lt;</span><span class="n">S</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&lt;=</span><span class="n">S</span><span class="o">&amp;&amp;</span><span class="n">E</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">];</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span><span class="o">+</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">bisearch</span><span class="p">(</span><span class="n">T</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="n">R</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">))</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">lo</span> <span class="o">=</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span> <span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">R</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">lo</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">hi</span><span class="p">){</span>
            <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span><span class="o">+</span><span class="n">hi</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">)){</span>
                <span class="n">hi</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">lo</span> <span class="o">=</span> <span class="n">mid</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">hi</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="c1">// ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸°</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">HLD</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">T</span> <span class="n">cost</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">dep</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">T</span> <span class="n">top</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">T</span> <span class="n">R</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span> <span class="c1">//inì˜ ì—­í•¨ìˆ˜ë¥¼ ì„¤ì •í–ˆìŒ</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">input</span><span class="p">,</span> <span class="n">inp</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">bool</span> <span class="n">visited</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">ncost</span><span class="p">,</span> <span class="n">nxt</span><span class="p">]</span> <span class="o">:</span> <span class="n">inp</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">nxt</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">cost</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncost</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">dep</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">now</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">par</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
            <span class="n">dfs1</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span><span class="o">&gt;</span><span class="n">sz</span><span class="p">[</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">nxt</span><span class="p">,</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
        <span class="n">in</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tmp</span><span class="p">;</span>
        <span class="n">R</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">top</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nxt</span><span class="o">==</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="n">top</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">:</span> <span class="n">nxt</span><span class="p">);</span>
            <span class="n">dfs2</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">out</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">Segtree</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
    
    <span class="c1">// i ë²ˆ ê°„ì„ ì„ valë¡œ</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="n">val</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">//u, vìœ„ ê°€ì¥ ë¨¼ì €ë‚˜ì˜¤ëŠ” 1</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">T</span> <span class="n">ret</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">!=</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">ST</span> <span class="o">=</span> <span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
            <span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">bisearch</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">ST</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">ST</span><span class="p">];</span>
        <span class="p">}</span>
            
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="n">st</span><span class="p">.</span><span class="n">bisearch</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">now</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">ret</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="n">ret</span> <span class="o">:</span> <span class="n">R</span><span class="p">[</span><span class="n">ret</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="nf">lca</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">precal</span><span class="p">(){</span>
        <span class="n">input</span> <span class="o">=</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
            <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">};</span>
            <span class="n">inp</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">});</span>
            <span class="n">inp</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="n">top</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">();</span> <span class="n">dfs1</span><span class="p">();</span> <span class="n">dfs2</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">HLD</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">hld</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">fast_io</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">hld</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">hld</span><span class="p">.</span><span class="n">precal</span><span class="p">();</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">q</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">op</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">op</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
            <span class="n">hld</span><span class="p">.</span><span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">);</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hld</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="2927-ë‚¨ê·¹íƒí—˜"><span class="me-2"><a href="https://www.acmicpc.net/problem/2927">2927 ë‚¨ê·¹íƒí—˜</a></span><a href="#2927-ë‚¨ê·¹íƒí—˜" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>ìš°ë¦¬ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ í™•ì •ëœ ìƒíƒœì—ì„œ HLDë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œë¥¼ í’€ì—ˆì§€ë§Œ ì´ ë¬¸ì œëŠ” íŠ¸ë¦¬ êµ¬ì¡°ê°€ ì™„ì„±ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì´ëŸ° ê²½ìš° ì™„ì„± ë˜ì—ˆì„ ë•Œì˜ ë¬¸ì œë¡œ ì¹˜í™˜ì„ í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤.</p>

<p>ì´ ë•Œ <strong>ì˜¤í”„ë¼ì¸ ì¿¼ë¦¬</strong>ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì¼ë‹¨, bridgeì—°ì‚°ì€ <strong>Union Find</strong>ë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ì—°ì‚°ì„ í†µí•´ ë§Œë“¤ì–´ì§„ ê·¸ë˜í”„ëŠ” ë¬´ì¡°ê±´ íŠ¸ë¦¬ í˜•íƒœì´ë‹¤. í•˜ì§€ë§Œ bridgeì—°ì‚°ì´ ì •í™•íˆ n-1ê°œì˜ yesê°€ ë‚˜ì˜¨ë‹¤ëŠ” ë³´ì¥ì´ ì—†ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ íŠ¸ë¦¬ê°€ ë§Œë“¤ì–´ ì§ˆ ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ íŠ¸ë¦¬ë¥¼ í•©ì³ì„œ í•˜ë‚˜ì˜ íŠ¸ë¦¬ë¥¼ ë§Œë“œëŠ” ì•„ì´ë””ì–´ë¥¼ ë– ì˜¬ë¦´ ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>ì´ì œ excursion ì—°ì‚°ì— ëŒ€í•´ ê³ ë¯¼í•´ë³´ì.</p>

<p>excursionì€ ì¼ë‹¨ ê¸¸ì´ ì—†ìœ¼ë©´ â€œinpossibleâ€ì„ ì¶œë ¥í•œë‹¤. ê·¼ë° ì´ ê²½ìš°ëŠ” ê·¸ëƒ¥ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œë„ í•´ê²° í•  ìˆ˜ ìˆë‹¤. ë‚˜ë¨¸ì§€ ê¸¸ì´ ìˆëŠ” ê²½ìš°ëŠ” <strong>íŠ¸ë¦¬ì—ì„œëŠ” ì •ì  u, v ì‚¬ì´ì˜ ê¸¸ì´ í•˜ë‚˜ ë°–ì— ì—†ê¸° ë•Œë¬¸ì—</strong> ê·¸ëƒ¥ HLDì´ìš©í•˜ë©´ ëœë‹¤.</p>

<p>ê²°ë¡  :</p>

<p>â†’ ìˆœì„œëŒ€ë¡œ ë³´ë©´ì„œ excursionì¤‘ì— ë¶ˆê°€ëŠ¥í•œ ê±°ëŠ” ë¯¸ë¦¬ ê³¨ë¼ ë‘”ë‹¤.</p>

<p>â†’ ì´ì œ ì™„ì„±ëœ íŠ¸ë¦¬ë¥¼ ê°€ì§€ê³  ì¿¼ë¦¬ë¥¼ ê±°ê¾¸ë¡œ ë³´ë©´ì„œ ê²½ë¡œ ì¿¼ë¦¬ë¡œ ê¸¸ì´ ìˆëŠ” ê²½ìš°ë¥¼ ê³„ì‚°í•œë‹¤.</p>

<p>â†’ penguins ì—°ì‚°ì€ ì—­ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ì‹ìœ¼ë¡œ í•´ì•¼í•œë‹¤. (ì„¸ê·¸ë¨¼íŠ¸ íŠ¸ë¦¬ updateí•˜ë©´ ëœë‹¤. )</p>

<ul>
  <li>ë§ˆì§€ë§‰ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•  ë•Œ
    <ul>
      <li>bridgeë¼ë©´
        <ul>
          <li>ë¯¸ë¦¬ ì €ì¥ëœ 1 â†’ yes 0 â†’ no</li>
        </ul>
      </li>
      <li>penguinsë¼ë©´
        <ul>
          <li>continue</li>
        </ul>
      </li>
      <li>excursionë¼ë©´
        <ul>
          <li>Unionfindë¡œ í‰ê°€í–ˆì„ ë•Œ ì´ë¯¸ -1 â†’ â€œimpossibleâ€</li>
          <li>ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ query(a, b)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>ìì„¸í•œê±´ ì•„ë˜ ì½”ë“œì—ì„œ ì£¼ì„ ì²˜ë¦¬ë¡œ ë³´ì´ê² ë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="code-header">
        <span data-label-text="Cpp"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#define fast_io cin.tie(NULL); ios_base::sync_with_stdio(false);
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span> <span class="n">ll</span><span class="o">&gt;</span> <span class="n">pll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">tuple</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">tiii</span><span class="p">;</span>
<span class="cp">#define xx first
#define yy second
</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MAXSIZE</span> <span class="o">=</span> <span class="mf">3e4</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">P</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>

<span class="k">struct</span> <span class="nc">DisjointSet</span><span class="p">{</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">parent</span><span class="p">,</span> <span class="n">rank</span><span class="p">;</span>
    
    <span class="n">DisjointSet</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span><span class="n">parent</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">rank</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">parent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">parent</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">parent</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">parent</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
    <span class="p">}</span>
    
    <span class="kt">bool</span> <span class="nf">merge</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">&gt;</span><span class="n">rank</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="n">parent</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">rank</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">==</span><span class="n">rank</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">rank</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="nf">check</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="n">v</span><span class="p">)</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// êµ¬ê°„í•© ì„¸ê·¸</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">Segtree</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">TREESIZE</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">MAXSIZE</span><span class="p">;</span>
    <span class="n">T</span><span class="o">*</span> <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="n">T</span><span class="p">[</span><span class="n">TREESIZE</span><span class="p">];</span>

    <span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">TREESIZE</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">~</span><span class="n">Segtree</span><span class="p">(){</span>
        <span class="k">delete</span><span class="p">[]</span> <span class="n">tree</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span> <span class="c1">// ì›ì†Œêµì²´ì—°ì‚°, ë”í•˜ê¸°ë©´ +í•˜ì…ˆ</span>
        
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">)</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
        <span class="k">else</span> <span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">+</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">kth</span><span class="p">(</span><span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="n">K</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">S</span><span class="o">==</span><span class="n">E</span><span class="p">)</span> <span class="k">return</span> <span class="n">S</span><span class="p">;</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">K</span><span class="p">)</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span>
        <span class="k">else</span> <span class="k">return</span> <span class="n">kth</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="n">tree</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span> <span class="n">node</span><span class="p">,</span> <span class="n">T</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span> <span class="n">E</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;</span><span class="n">E</span><span class="o">||</span><span class="n">R</span><span class="o">&lt;</span><span class="n">S</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="o">&lt;=</span><span class="n">S</span><span class="o">&amp;&amp;</span><span class="n">E</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">)</span> <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="n">node</span><span class="p">];</span>
        <span class="n">T</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">S</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span><span class="o">+</span><span class="n">query</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">node</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="c1">// ê²½ë¡œ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸°</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="p">&gt;</span>
<span class="k">class</span> <span class="nc">HLD</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">T</span> <span class="n">cost</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">dep</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">par</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">T</span> <span class="n">top</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;&gt;</span> <span class="n">input</span><span class="p">,</span> <span class="n">inp</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">adj</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">bool</span> <span class="n">visited</span><span class="p">[</span><span class="n">MAXSIZE</span><span class="p">];</span>
    
    <span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">ncost</span><span class="p">,</span> <span class="n">nxt</span><span class="p">]</span> <span class="o">:</span> <span class="n">inp</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">visited</span><span class="p">[</span><span class="n">nxt</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">push_back</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">cost</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncost</span><span class="p">;</span>
            <span class="n">dfs</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">dfs1</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
        <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span><span class="o">&amp;</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">dep</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">dep</span><span class="p">[</span><span class="n">now</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">par</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="n">now</span><span class="p">;</span>
            <span class="n">dfs1</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
            <span class="n">sz</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span><span class="o">&gt;</span><span class="n">sz</span><span class="p">[</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">nxt</span><span class="p">,</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">//adj[now][0]ì—ëŠ” ê°€ì¥í°ê²ƒ (heavy)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="kt">void</span> <span class="nf">dfs2</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span> <span class="o">=</span> <span class="mi">0</span><span class="p">){</span>
        <span class="n">in</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="o">++</span><span class="n">tmp</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="n">T</span> <span class="n">nxt</span> <span class="o">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">]){</span>
            <span class="n">top</span><span class="p">[</span><span class="n">nxt</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nxt</span><span class="o">==</span><span class="n">adj</span><span class="p">[</span><span class="n">now</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="n">top</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">:</span> <span class="n">nxt</span><span class="p">);</span>
            <span class="n">dfs2</span><span class="p">(</span><span class="n">nxt</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">out</span><span class="p">[</span><span class="n">now</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">Segtree</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">st</span><span class="p">;</span>
    
    <span class="c1">// i ë²ˆ ê°„ì„ ì„ valë¡œ</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">T</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span> <span class="n">val</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">,</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">);</span>
        <span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">//u, vê²½ë¡œìƒ í­ê·„ì˜ ìˆ˜</span>
    <span class="n">T</span> <span class="nf">query</span><span class="p">(</span><span class="n">T</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">T</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">!=</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">ST</span> <span class="o">=</span> <span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
            <span class="n">ret</span> <span class="o">+=</span> <span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">ST</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">ST</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="n">ret</span> <span class="o">+=</span> <span class="n">st</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">in</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">int</span> <span class="nf">lca</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">!=</span> <span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span> <span class="o">&lt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">v</span><span class="p">]])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="n">u</span><span class="p">]];</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dep</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dep</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">swap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">u</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="nf">precal</span><span class="p">(){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">inp</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">});</span>
            <span class="n">inp</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">});</span>
        <span class="p">}</span>
        
        <span class="n">top</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">();</span> <span class="n">dfs1</span><span class="p">();</span> <span class="n">dfs2</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="n">DisjointSet</span> <span class="nf">uf</span><span class="p">(</span><span class="n">MAXSIZE</span><span class="p">);</span>
<span class="n">HLD</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">hld</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Data</span><span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">string</span> <span class="n">op</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">,</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">pair</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">[</span><span class="mi">300005</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">fast_io</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">hld</span><span class="p">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">q</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Data</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">string</span> <span class="n">op</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">op</span><span class="o">==</span><span class="s">"bridge"</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">uf</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)){</span><span class="c1">//ì´ë¯¸ í•©ì³ì ¸ìˆìŒ</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"bridge"</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="c1">//í•©ì³ì•¼í•¨</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"bridge"</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>
                <span class="n">hld</span><span class="p">.</span><span class="n">inp</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">});</span>
                <span class="n">hld</span><span class="p">.</span><span class="n">inp</span><span class="p">[</span><span class="n">b</span><span class="p">].</span><span class="n">push_back</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">});</span>
            <span class="p">}</span>
            <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">};</span>
            
        <span class="p">}</span><span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">op</span><span class="o">==</span><span class="s">"penguins"</span><span class="p">){</span>
            <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">P</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">b</span><span class="p">};</span>
            <span class="n">P</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">uf</span><span class="p">.</span><span class="n">check</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)){</span> <span class="c1">//ì´ë¯¸ í•©ì³ì ¸ ìˆìŒ</span>
                <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">};</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"excursion"</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">};</span>
                <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">op</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">};</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">hld</span><span class="p">.</span><span class="n">precal</span><span class="p">();</span>   <span class="c1">//0ì´ ë£¨íŠ¸ì¸ í•˜ë‚˜ì˜ íŠ¸ë¦¬</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span> <span class="c1">//í­ê·„ì„ ê° ì„¬ì— ë„£ì–´ì¤Œ</span>
        <span class="n">hld</span><span class="p">.</span><span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">);</span>
    <span class="p">}</span>
    
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">q</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">op</span><span class="o">==</span><span class="s">"bridge"</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
	        <span class="k">if</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">op</span><span class="o">==</span><span class="s">"penguins"</span><span class="p">){</span>
            <span class="n">hld</span><span class="p">.</span><span class="n">st</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">hld</span><span class="p">.</span><span class="n">in</span><span class="p">[</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span><span class="p">],</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MAXSIZE</span><span class="p">);</span>
            <span class="n">ans</span><span class="p">[</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">op</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">p</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">ans</span><span class="p">[</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">op</span><span class="p">,</span> <span class="n">hld</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">a</span><span class="p">,</span> <span class="n">Q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">b</span><span class="p">)};</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">q</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="o">==</span><span class="s">"bridge"</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"yes</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"no</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">xx</span><span class="o">==</span><span class="s">"penguins"</span><span class="p">){</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"impossible</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">yy</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/problem-solving/">Problem Solving</a>,
          <a href="/categories/algorithm/">Algorithm</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/heavy-light%EB%B6%84%ED%95%A0/"
            class="post-tag no-text-decoration"
          >heavy-lightë¶„í• </a>
        
          <a
            href="/tags/%ED%8A%B8%EB%A6%AC/"
            class="post-tag no-text-decoration"
          >íŠ¸ë¦¬</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Heavy-Light%20decomposition%20-%20%EB%8F%84%EC%82%AC%EC%98%80%EB%8B%A4%20%EB%B8%94%EB%A1%9C%EA%B7%B8&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHLD%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Heavy-Light%20decomposition%20-%20%EB%8F%84%EC%82%AC%EC%98%80%EB%8B%A4%20%EB%B8%94%EB%A1%9C%EA%B7%B8&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHLD%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FHLD%2F&text=Heavy-Light%20decomposition%20-%20%EB%8F%84%EC%82%AC%EC%98%80%EB%8B%A4%20%EB%B8%94%EB%A1%9C%EA%B7%B8" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/%EB%AC%B8%EC%A0%9C%EC%9D%BC%EA%B8%B0/">2026-02-22 ë¬¸ì œí’€ì´</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/%EA%B7%BC%ED%99%A9-%EB%B0%8F-%EA%B3%84%ED%9A%8D/">ê·¼í™© í† í¬ ë° ì•ìœ¼ë¡œì˜ ë¸”ë¡œê·¸ ìš´ì˜ê³„íš</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/aho-corasick/">ë¬¸ìì—´ - ì•„í˜¸ ì½”ë¼ì‹(Aho-Corasick)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/docker-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0/">docker ì´í•´í•´ë³´ê¸°</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/2060-%EC%97%BC%EC%86%8C%EC%A4%84%EC%84%9C%EA%B8%B0-%ED%92%80%EC%9D%B4/">ì—¼ì†Œì¤„ì„œê¸° ë¬¸ì œ í’€ì´</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/upsolving/">upsolving</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%93%9C%ED%8F%AC%EC%8A%A4/">ì½”ë“œí¬ìŠ¤</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%84%B8%EA%B7%B8%EB%A8%BC%ED%8A%B8%ED%8A%B8%EB%A6%AC/">ì„¸ê·¸ë¨¼íŠ¸íŠ¸ë¦¬</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B2%8C%EC%9E%84%EB%A6%AC%EB%B7%B0/">ê²Œì„ë¦¬ë·°</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B7%B8%EB%9E%98%ED%94%84/">ê·¸ë˜í”„</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dnc/">DnC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kmp/">KMP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scc/">SCC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/segment-tree/">Segment Tree</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%8C%80%ED%9A%8C%ED%9B%84%EA%B8%B0/">ëŒ€íšŒí›„ê¸°</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Segment-Tree/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1655478000"
  data-df="ll"
  
>
  Jun 18, 2022
</time>

              <h4 class="pt-0 my-2">Segment Tree</h4>
              <div class="text-muted">
                <p>ë°±ì¤€ 11505 êµ¬ê°„ ê³± êµ¬í•˜ê¸° ë¬¸ì œí’€ì´  [11505 êµ¬ê°„ ê³± êµ¬í•˜ê¸°] https://www.acmicpc.net/problem/11505  .     segment treeë¥¼ ì´ìš©í•˜ì—¬ ë¹ ë¥´ê²Œ êµ¬ê°„ ê³±ì„ ë³€ê²½í•˜ê³  ì¶œë ¥í•œë‹¤.  ë¬¸ì œìƒí™© íŒŒì•…í•˜ê¸°. [2042 êµ¬ê°„ í•© êµ¬í•˜ê¸°] https://www.acmicpc.net/problem/2042  .  ìœ„ ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/KMP/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1655132400"
  data-df="ll"
  
>
  Jun 14, 2022
</time>

              <h4 class="pt-0 my-2">KMPì˜ Partial Match Table</h4>
              <div class="text-muted">
                <p>ë°±ì¤€ 1305 ê´‘ê³  ë¬¸ì œí’€ì´  [1305 ê´‘ê³ ] https://www.acmicpc.net/problem/1305  .     KMPì•Œê³ ë¦¬ì¦˜ baseì˜ failure functionì„ ì´ìš©í•´ì„œ ë¬¸ì œì˜ ë‹µì„ êµ¬í•œë‹¤.  ë¬¸ì œìƒí™© íŒŒì•…í•˜ê¸°. ê´‘ê³  ë¬¸êµ¬ê°€ ë  ìˆ˜ ìˆëŠ” ê²ƒì¤‘ ê°€ì¥ ì§§ì€ ê´‘ê³ ë¬¸êµ¬ë¥¼ ì°¾ëŠ” ë¬¸ì œì´ë‹¤ .  ê´‘ê³ ê°€ ë ìˆ˜ ìˆëŠ” ë¬¸êµ¬ 1ê¸€ì, 2ê¸€ì, 3ê¸€...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/MST&Prim_Algorithm/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1654959600"
  data-df="ll"
  
>
  Jun 12, 2022
</time>

              <h4 class="pt-0 my-2">Prim Algorithm optimazation</h4>
              <div class="text-muted">
                <p>ë°±ì¤€ 4386 ë³„ìë¦¬ ë§Œë“¤ê¸° ë¬¸ì œí’€ì´  [4386 ë³„ìë¦¬ ë§Œë“¤ê¸°] https://www.acmicpc.net/problem/4386  .     ê°„ì„ ì„ ì¶”ë ¤ì„œ MST(minimum spanning tree)ë¥¼ ë§Œë“ ë‹¤.  ë¬¸ì œìƒí™© íŒŒì•…í•˜ê¸°. ì •ì ë“¤ì˜ ìœ„ì¹˜ê°€ ì£¼ì–´ì§€ê³  ì´ë™ì€ ì–´ë””ë“  í•  ìˆ˜ ìˆë‹¤ .  ì´ë™ í• ë•Œ ê·¸ ê±°ë¦¬ëŠ” ì ê³¼ ì ì‚¬ì´ì˜ ê±°ë¦¬ì´ë‹¤.     ëª¨...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/%ED%96%89%EB%A0%AC%EA%B1%B0%EB%93%AD%EC%A0%9C%EA%B3%B1/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>í–‰ë ¬ ê±°ë“­ì œê³±</p>
    </a>
  

  
    <a
      href="/posts/Edu-Codeforce-round-148-(Div-2)/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>ì½”ë“œí¬ìŠ¤ - ì—°ìŠµì¤‘1</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>Â©
    <time>2026</time>

    
      <a href="https://github.com/Dosawasseungjun">Han Seungjun</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.4.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/upsolving/">upsolving</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%BD%94%EB%93%9C%ED%8F%AC%EC%8A%A4/">ì½”ë“œí¬ìŠ¤</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EC%84%B8%EA%B7%B8%EB%A8%BC%ED%8A%B8%ED%8A%B8%EB%A6%AC/">ì„¸ê·¸ë¨¼íŠ¸íŠ¸ë¦¬</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B2%8C%EC%9E%84%EB%A6%AC%EB%B7%B0/">ê²Œì„ë¦¬ë·°</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EA%B7%B8%EB%9E%98%ED%94%84/">ê·¸ë˜í”„</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/dnc/">DnC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kmp/">KMP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/scc/">SCC</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/segment-tree/">Segment Tree</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%EB%8C%80%ED%9A%8C%ED%9B%84%EA%B8%B0/">ëŒ€íšŒí›„ê¸°</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script>
  (function () {
    const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed');
    const initTheme = themeMapper[Theme.visualState];

    let lang = 'ko';if (lang.length > 2 && !lang.startsWith('zh')) {
      lang = lang.slice(0, 2);
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'Dosawasseungjun/blog-comment',
      'data-repo-id': 'R_kgDOHfpjWA',
      'data-category': 'General',
      'data-category-id': 'DIC_kwDOHfpjWM4C20ro',
      'data-mapping': 'pathname',
      'data-strict' : '0',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'bottom',
      'data-lang': lang,
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusNode = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusNode.setAttribute(key, value)
    );

    const $footer = document.querySelector('footer');
    $footer.insertAdjacentElement("beforebegin", giscusNode);

    addEventListener('message', (event) => {
      if (event.source === window && event.data && event.data.id === Theme.ID) {
        const newTheme = themeMapper[Theme.visualState];

        const message = {
          setConfig: {
            theme: newTheme
          }
        };

        const giscus =
          document.getElementsByClassName('giscus-frame')[0].contentWindow;
        giscus.postMessage({ giscus: message }, 'https://giscus.app');
      }
    });
  })();
</script>



    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

